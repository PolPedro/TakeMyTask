function cov_2qojw0v2qc(){var path="C:\\Users\\polpe\\bootcamp\\collab\\skylab-bootcamp-202004\\staff\\pol-pedro\\takemytask\\takemytask-client-logic\\add-message.spec.js";var hash="ae0ad259ce26cc8c305d4bbfbf3bd32af07ec9ce";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\polpe\\bootcamp\\collab\\skylab-bootcamp-202004\\staff\\pol-pedro\\takemytask\\takemytask-client-logic\\add-message.spec.js",statementMap:{"0":{start:{line:1,column:0},end:{line:1,column:26}},"1":{start:{line:3,column:96},end:{line:3,column:103}},"2":{start:{line:5,column:19},end:{line:5,column:43}},"3":{start:{line:6,column:19},end:{line:6,column:23}},"4":{start:{line:7,column:19},end:{line:7,column:34}},"5":{start:{line:8,column:0},end:{line:8,column:44}},"6":{start:{line:9,column:35},end:{line:9,column:64}},"7":{start:{line:10,column:84},end:{line:10,column:110}},"8":{start:{line:11,column:0},end:{line:11,column:43}},"9":{start:{line:12,column:16},end:{line:12,column:36}},"10":{start:{line:14,column:0},end:{line:14,column:25}},"11":{start:{line:16,column:0},end:{line:16,column:20}},"12":{start:{line:18,column:0},end:{line:141,column:2}},"13":{start:{line:19,column:4},end:{line:19,column:47}},"14":{start:{line:19,column:17},end:{line:19,column:46}},"15":{start:{line:23,column:4},end:{line:72,column:6}},"16":{start:{line:24,column:8},end:{line:24,column:31}},"17":{start:{line:25,column:8},end:{line:25,column:33}},"18":{start:{line:26,column:8},end:{line:26,column:31}},"19":{start:{line:28,column:8},end:{line:28,column:33}},"20":{start:{line:29,column:8},end:{line:29,column:39}},"21":{start:{line:30,column:8},end:{line:30,column:40}},"22":{start:{line:31,column:8},end:{line:31,column:41}},"23":{start:{line:32,column:8},end:{line:32,column:37}},"24":{start:{line:34,column:8},end:{line:34,column:34}},"25":{start:{line:35,column:8},end:{line:35,column:40}},"26":{start:{line:36,column:8},end:{line:36,column:41}},"27":{start:{line:37,column:8},end:{line:37,column:42}},"28":{start:{line:38,column:8},end:{line:38,column:38}},"29":{start:{line:39,column:8},end:{line:39,column:45}},"30":{start:{line:40,column:8},end:{line:40,column:49}},"31":{start:{line:41,column:8},end:{line:41,column:47}},"32":{start:{line:42,column:8},end:{line:42,column:33}},"33":{start:{line:43,column:8},end:{line:43,column:51}},"34":{start:{line:44,column:8},end:{line:44,column:37}},"35":{start:{line:46,column:23},end:{line:46,column:202}},"36":{start:{line:48,column:8},end:{line:48,column:28}},"37":{start:{line:50,column:21},end:{line:54,column:10}},"38":{start:{line:56,column:8},end:{line:56,column:39}},"39":{start:{line:58,column:8},end:{line:58,column:42}},"40":{start:{line:60,column:8},end:{line:66,column:11}},"41":{start:{line:68,column:8},end:{line:68,column:25}},"42":{start:{line:70,column:8},end:{line:70,column:36}},"43":{start:{line:73,column:4},end:{line:117,column:6}},"44":{start:{line:74,column:8},end:{line:81,column:10}},"45":{start:{line:75,column:25},end:{line:75,column:84}},"46":{start:{line:77,column:12},end:{line:77,column:29}},"47":{start:{line:79,column:12},end:{line:80,column:63}},"48":{start:{line:80,column:33},end:{line:80,column:62}},"49":{start:{line:83,column:8},end:{line:94,column:10}},"50":{start:{line:85,column:12},end:{line:85,column:48}},"51":{start:{line:87,column:28},end:{line:87,column:45}},"52":{start:{line:89,column:27},end:{line:89,column:34}},"53":{start:{line:91,column:12},end:{line:91,column:33}},"54":{start:{line:92,column:12},end:{line:92,column:82}},"55":{start:{line:93,column:12},end:{line:93,column:65}},"56":{start:{line:96,column:8},end:{line:105,column:10}},"57":{start:{line:97,column:12},end:{line:104,column:13}},"58":{start:{line:99,column:16},end:{line:99,column:44}},"59":{start:{line:102,column:16},end:{line:102,column:40}},"60":{start:{line:103,column:16},end:{line:103,column:68}},"61":{start:{line:107,column:8},end:{line:116,column:10}},"62":{start:{line:109,column:27},end:{line:114,column:18}},"63":{start:{line:112,column:20},end:{line:112,column:42}},"64":{start:{line:113,column:20},end:{line:113,column:103}},"65":{start:{line:119,column:4},end:{line:136,column:6}},"66":{start:{line:121,column:8},end:{line:125,column:10}},"67":{start:{line:122,column:12},end:{line:122,column:47}},"68":{start:{line:123,column:12},end:{line:124,column:63}},"69":{start:{line:124,column:33},end:{line:124,column:62}},"70":{start:{line:126,column:8},end:{line:135,column:10}},"71":{start:{line:128,column:27},end:{line:133,column:18}},"72":{start:{line:131,column:20},end:{line:131,column:42}},"73":{start:{line:132,column:20},end:{line:132,column:88}},"74":{start:{line:138,column:4},end:{line:138,column:78}},"75":{start:{line:138,column:20},end:{line:138,column:39}},"76":{start:{line:140,column:4},end:{line:140,column:30}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:18,column:32},end:{line:18,column:33}},loc:{start:{line:18,column:38},end:{line:141,column:1}},line:18},"1":{name:"(anonymous_1)",decl:{start:{line:19,column:11},end:{line:19,column:12}},loc:{start:{line:19,column:17},end:{line:19,column:46}},line:19},"2":{name:"(anonymous_2)",decl:{start:{line:23,column:15},end:{line:23,column:16}},loc:{start:{line:23,column:27},end:{line:72,column:5}},line:23},"3":{name:"(anonymous_3)",decl:{start:{line:73,column:28},end:{line:73,column:29}},loc:{start:{line:73,column:34},end:{line:117,column:5}},line:73},"4":{name:"(anonymous_4)",decl:{start:{line:74,column:19},end:{line:74,column:20}},loc:{start:{line:74,column:31},end:{line:81,column:9}},line:74},"5":{name:"(anonymous_5)",decl:{start:{line:80,column:22},end:{line:80,column:23}},loc:{start:{line:80,column:33},end:{line:80,column:62}},line:80},"6":{name:"(anonymous_6)",decl:{start:{line:83,column:47},end:{line:83,column:48}},loc:{start:{line:83,column:59},end:{line:94,column:9}},line:83},"7":{name:"(anonymous_7)",decl:{start:{line:96,column:46},end:{line:96,column:47}},loc:{start:{line:96,column:58},end:{line:105,column:9}},line:96},"8":{name:"(anonymous_8)",decl:{start:{line:107,column:49},end:{line:107,column:50}},loc:{start:{line:107,column:61},end:{line:116,column:9}},line:107},"9":{name:"(anonymous_9)",decl:{start:{line:111,column:23},end:{line:111,column:24}},loc:{start:{line:111,column:32},end:{line:114,column:17}},line:111},"10":{name:"(anonymous_10)",decl:{start:{line:119,column:33},end:{line:119,column:34}},loc:{start:{line:119,column:39},end:{line:136,column:5}},line:119},"11":{name:"(anonymous_11)",decl:{start:{line:121,column:19},end:{line:121,column:20}},loc:{start:{line:121,column:30},end:{line:125,column:9}},line:121},"12":{name:"(anonymous_12)",decl:{start:{line:124,column:22},end:{line:124,column:23}},loc:{start:{line:124,column:33},end:{line:124,column:62}},line:124},"13":{name:"(anonymous_13)",decl:{start:{line:126,column:50},end:{line:126,column:51}},loc:{start:{line:126,column:62},end:{line:135,column:9}},line:126},"14":{name:"(anonymous_14)",decl:{start:{line:130,column:23},end:{line:130,column:24}},loc:{start:{line:130,column:32},end:{line:133,column:17}},line:130},"15":{name:"(anonymous_15)",decl:{start:{line:138,column:14},end:{line:138,column:15}},loc:{start:{line:138,column:20},end:{line:138,column:39}},line:138}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"ae0ad259ce26cc8c305d4bbfbf3bd32af07ec9ce"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2qojw0v2qc=function(){return actualCoverage;};}return actualCoverage;}cov_2qojw0v2qc();cov_2qojw0v2qc().s[0]++;require('dotenv').config();const{env:{TEST_MONGODB_URL:MONGODB_URL,TEST_SECRET:SECRET,TEST_API_URL:API_URL}}=(cov_2qojw0v2qc().s[1]++,process);const addMessage=(cov_2qojw0v2qc().s[2]++,require('./add-message'));const{random}=(cov_2qojw0v2qc().s[3]++,Math);const{expect}=(cov_2qojw0v2qc().s[4]++,require('chai'));cov_2qojw0v2qc().s[5]++;require('takemytask-commons/polyfills/json');const{utils:{jwtPromised}}=(cov_2qojw0v2qc().s[6]++,require('takemytask-commons'));const{mongoose,models:{User,Worker,Chat,Comments},mongoose:{ObjectId}}=(cov_2qojw0v2qc().s[7]++,require('takemytask-data'));cov_2qojw0v2qc().s[8]++;require('takemytask-commons/ponyfills/xhr');const context=(cov_2qojw0v2qc().s[9]++,require('./context'));cov_2qojw0v2qc().s[10]++;context.API_URL=API_URL;cov_2qojw0v2qc().s[11]++;context.storage={};cov_2qojw0v2qc().s[12]++;describe('logic - add message',()=>{cov_2qojw0v2qc().f[0]++;cov_2qojw0v2qc().s[13]++;before(()=>{cov_2qojw0v2qc().f[1]++;cov_2qojw0v2qc().s[14]++;return mongoose.connect(MONGODB_URL);});let name,surname,email,password,adress,bankAcount,description,pricingHour,jobCategories,workingDistance,workerId,coment,userId,chatId,newMessage;cov_2qojw0v2qc().s[15]++;beforeEach(async()=>{cov_2qojw0v2qc().f[2]++;cov_2qojw0v2qc().s[16]++;await User.deleteMany();cov_2qojw0v2qc().s[17]++;await Worker.deleteMany();cov_2qojw0v2qc().s[18]++;await Chat.deleteMany();cov_2qojw0v2qc().s[19]++;name=`name-${random()}`;cov_2qojw0v2qc().s[20]++;surname=`surname-${random()}`;cov_2qojw0v2qc().s[21]++;email=`e-${random()}@mail.com`;cov_2qojw0v2qc().s[22]++;password=`password-${random()}`;cov_2qojw0v2qc().s[23]++;adress=`street-${random()}`;cov_2qojw0v2qc().s[24]++;nameW=`name-${random()}`;cov_2qojw0v2qc().s[25]++;surnameW=`surname-${random()}`;cov_2qojw0v2qc().s[26]++;emailW=`e-${random()}@mail.com`;cov_2qojw0v2qc().s[27]++;passwordW=`password-${random()}`;cov_2qojw0v2qc().s[28]++;adressW=`street-${random()}`;cov_2qojw0v2qc().s[29]++;bankAcount=`bankAcount-${random()}`;cov_2qojw0v2qc().s[30]++;presentation=`presentation-${random()}`;cov_2qojw0v2qc().s[31]++;description=`description-${random()}`;cov_2qojw0v2qc().s[32]++;pricingHour=random()*10;cov_2qojw0v2qc().s[33]++;jobCategories=`jobCategories-${random()}`;cov_2qojw0v2qc().s[34]++;workingDistance=random()*10;const worker=(cov_2qojw0v2qc().s[35]++,await Worker.create({name:nameW,surname:surnameW,email:emailW,password,adress,adressW,bankAcount,description,presentation,pricingHour,jobCategories,workingDistance}));cov_2qojw0v2qc().s[36]++;workerId=worker.id;const chat=(cov_2qojw0v2qc().s[37]++,await Chat.create({user:ObjectId(userId),worker:ObjectId(workerId),date:new Date()}));cov_2qojw0v2qc().s[38]++;message='hello'+worker.name;cov_2qojw0v2qc().s[39]++;newMessage=`message-${random()}`;cov_2qojw0v2qc().s[40]++;chat.messages.unshift(new Comments({userId:ObjectId(userId),name:name,surname:surname,text:message,date:new Date()}));cov_2qojw0v2qc().s[41]++;await chat.save();cov_2qojw0v2qc().s[42]++;chatId=chat._id.toString();});cov_2qojw0v2qc().s[43]++;describe('user exists',()=>{cov_2qojw0v2qc().f[3]++;cov_2qojw0v2qc().s[44]++;beforeEach(async()=>{cov_2qojw0v2qc().f[4]++;const user=(cov_2qojw0v2qc().s[45]++,await User.create({name,surname,email,password,adress}));cov_2qojw0v2qc().s[46]++;userId=user._id;cov_2qojw0v2qc().s[47]++;return jwtPromised.sign({sub:user.id},SECRET).then(token=>{cov_2qojw0v2qc().f[5]++;cov_2qojw0v2qc().s[48]++;return context.storage.token=token;});});cov_2qojw0v2qc().s[49]++;it('should succeed on adding message',async()=>{cov_2qojw0v2qc().f[6]++;cov_2qojw0v2qc().s[50]++;await addMessage(chatId,newMessage);const results=(cov_2qojw0v2qc().s[51]++,await Chat.find());const[chat]=(cov_2qojw0v2qc().s[52]++,results);cov_2qojw0v2qc().s[53]++;expect(chat).to.exist;cov_2qojw0v2qc().s[54]++;expect(chat.messages[0].userId.toString()).to.equal(userId.toString());cov_2qojw0v2qc().s[55]++;expect(chat.messages[0].text).to.be.equal(newMessage);});cov_2qojw0v2qc().s[56]++;it('should succeed on adding coment',async()=>{cov_2qojw0v2qc().f[7]++;cov_2qojw0v2qc().s[57]++;try{cov_2qojw0v2qc().s[58]++;await addMessage(chatId,"");}catch({message}){cov_2qojw0v2qc().s[59]++;expect(message).to.exist;cov_2qojw0v2qc().s[60]++;expect(message).to.equal("string is empty or blank");}});cov_2qojw0v2qc().s[61]++;it('sould fail when chat id dont exist',async()=>{cov_2qojw0v2qc().f[8]++;const result=(cov_2qojw0v2qc().s[62]++,await addMessage('5ee0ed9a603a0a4f3c650fe1',newMessage).then().catch(error=>{cov_2qojw0v2qc().f[9]++;cov_2qojw0v2qc().s[63]++;expect(error).to.exist;cov_2qojw0v2qc().s[64]++;expect(error.message).to.equal(`chat with id 5ee0ed9a603a0a4f3c650fe1 dont exists`);}));});});cov_2qojw0v2qc().s[65]++;describe('User dont exists',()=>{cov_2qojw0v2qc().f[10]++;let fakeId;cov_2qojw0v2qc().s[66]++;beforeEach(async()=>{cov_2qojw0v2qc().f[11]++;cov_2qojw0v2qc().s[67]++;fakeId='5ee0ed9a603a0a4f3c650fe1';cov_2qojw0v2qc().s[68]++;return jwtPromised.sign({sub:fakeId},SECRET).then(token=>{cov_2qojw0v2qc().f[12]++;cov_2qojw0v2qc().s[69]++;return context.storage.token=token;});});cov_2qojw0v2qc().s[70]++;it('sould fail when user id dont exitst',async()=>{cov_2qojw0v2qc().f[13]++;const result=(cov_2qojw0v2qc().s[71]++,await addMessage(chatId,newMessage).then().catch(error=>{cov_2qojw0v2qc().f[14]++;cov_2qojw0v2qc().s[72]++;expect(error).to.exist;cov_2qojw0v2qc().s[73]++;expect(error.message).to.equal(`user with id ${fakeId} dont exists`);}));});});cov_2qojw0v2qc().s[74]++;afterEach(()=>{cov_2qojw0v2qc().f[15]++;cov_2qojw0v2qc().s[75]++;return Worker.deleteMany();},User.deleteMany(),Chat.deleteMany());cov_2qojw0v2qc().s[76]++;after(mongoose.disconnect);});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkZC1tZXNzYWdlLnNwZWMuanMiXSwibmFtZXMiOlsicmVxdWlyZSIsImNvbmZpZyIsImVudiIsIlRFU1RfTU9OR09EQl9VUkwiLCJNT05HT0RCX1VSTCIsIlRFU1RfU0VDUkVUIiwiU0VDUkVUIiwiVEVTVF9BUElfVVJMIiwiQVBJX1VSTCIsInByb2Nlc3MiLCJhZGRNZXNzYWdlIiwicmFuZG9tIiwiTWF0aCIsImV4cGVjdCIsInV0aWxzIiwiand0UHJvbWlzZWQiLCJtb25nb29zZSIsIm1vZGVscyIsIlVzZXIiLCJXb3JrZXIiLCJDaGF0IiwiQ29tbWVudHMiLCJPYmplY3RJZCIsImNvbnRleHQiLCJzdG9yYWdlIiwiZGVzY3JpYmUiLCJiZWZvcmUiLCJjb25uZWN0IiwibmFtZSIsInN1cm5hbWUiLCJlbWFpbCIsInBhc3N3b3JkIiwiYWRyZXNzIiwiYmFua0Fjb3VudCIsImRlc2NyaXB0aW9uIiwicHJpY2luZ0hvdXIiLCJqb2JDYXRlZ29yaWVzIiwid29ya2luZ0Rpc3RhbmNlIiwid29ya2VySWQiLCJjb21lbnQiLCJ1c2VySWQiLCJjaGF0SWQiLCJuZXdNZXNzYWdlIiwiYmVmb3JlRWFjaCIsImRlbGV0ZU1hbnkiLCJuYW1lVyIsInN1cm5hbWVXIiwiZW1haWxXIiwicGFzc3dvcmRXIiwiYWRyZXNzVyIsInByZXNlbnRhdGlvbiIsIndvcmtlciIsImNyZWF0ZSIsImlkIiwiY2hhdCIsInVzZXIiLCJkYXRlIiwiRGF0ZSIsIm1lc3NhZ2UiLCJtZXNzYWdlcyIsInVuc2hpZnQiLCJ0ZXh0Iiwic2F2ZSIsIl9pZCIsInRvU3RyaW5nIiwic2lnbiIsInN1YiIsInRoZW4iLCJ0b2tlbiIsIml0IiwicmVzdWx0cyIsImZpbmQiLCJ0byIsImV4aXN0IiwiZXF1YWwiLCJiZSIsInJlc3VsdCIsImNhdGNoIiwiZXJyb3IiLCJmYWtlSWQiLCJhZnRlckVhY2giLCJhZnRlciIsImRpc2Nvbm5lY3QiXSwibWFwcGluZ3MiOiJzK1BBZVk7bUhBZlpBLE9BQU8sQ0FB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QTFCLENBQTRCMUIsSUFBSSxDQUFDMEIsVUFBTCxFQUE1QixDQUErQ3hCLElBQUksQ0FBQ3dCLFVBQUwsRUFBL0MsQ0FBVCxDQXhIa0MseUJBMEhsQ3FDLEtBQUssQ0FBQ2pFLFFBQVEsQ0FBQ2tFLFVBQVYsQ0FBTCxDQUNILENBM0hPLENBQVIiLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCdkb3RlbnYnKS5jb25maWcoKVxyXG5cclxuY29uc3QgeyBlbnY6IHsgVEVTVF9NT05HT0RCX1VSTDogTU9OR09EQl9VUkwsIFRFU1RfU0VDUkVUOiBTRUNSRVQsIFRFU1RfQVBJX1VSTDogQVBJX1VSTCAgfSB9ID0gcHJvY2Vzc1xyXG5cclxuY29uc3QgYWRkTWVzc2FnZSA9IHJlcXVpcmUoJy4vYWRkLW1lc3NhZ2UnKVxyXG5jb25zdCB7IHJhbmRvbSB9ID0gTWF0aFxyXG5jb25zdCB7IGV4cGVjdCB9ID0gcmVxdWlyZSgnY2hhaScpXHJcbnJlcXVpcmUoJ3Rha2VteXRhc2stY29tbW9ucy9wb2x5ZmlsbHMvanNvbicpXHJcbmNvbnN0IHsgdXRpbHM6IHsgand0UHJvbWlzZWQgfSB9ID0gcmVxdWlyZSgndGFrZW15dGFzay1jb21tb25zJylcclxuY29uc3QgeyBtb25nb29zZSwgbW9kZWxzOiB7VXNlciwgV29ya2VyLCBDaGF0LCBDb21tZW50cyB9LCBtb25nb29zZToge09iamVjdElkfSB9ID0gcmVxdWlyZSgndGFrZW15dGFzay1kYXRhJylcclxucmVxdWlyZSgndGFrZW15dGFzay1jb21tb25zL3BvbnlmaWxscy94aHInKVxyXG5jb25zdCBjb250ZXh0ID0gcmVxdWlyZSgnLi9jb250ZXh0JylcclxuXHJcbmNvbnRleHQuQVBJX1VSTCA9IEFQSV9VUkxcclxuXHJcbmNvbnRleHQuc3RvcmFnZSA9IHt9XHJcblxyXG5kZXNjcmliZSgnbG9naWMgLSBhZGQgbWVzc2FnZScsICgpID0+IHtcclxuICAgIGJlZm9yZSgoKSA9PiBtb25nb29zZS5jb25uZWN0KE1PTkdPREJfVVJMKSlcclxuXHJcbiAgICBsZXQgbmFtZSwgc3VybmFtZSwgZW1haWwsIHBhc3N3b3JkLCBhZHJlc3MsIGJhbmtBY291bnQsIGRlc2NyaXB0aW9uLCBwcmljaW5nSG91ciwgam9iQ2F0ZWdvcmllcywgd29ya2luZ0Rpc3RhbmNlLCB3b3JrZXJJZCwgY29tZW50LCB1c2VySWQsIGNoYXRJZCwgbmV3TWVzc2FnZVxyXG5cclxuICAgIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIGF3YWl0IFVzZXIuZGVsZXRlTWFueSgpXHJcbiAgICAgICAgYXdhaXQgV29ya2VyLmRlbGV0ZU1hbnkoKVxyXG4gICAgICAgIGF3YWl0IENoYXQuZGVsZXRlTWFueSgpXHJcblxyXG4gICAgICAgIG5hbWUgPSBgbmFtZS0ke3JhbmRvbSgpfWBcclxuICAgICAgICBzdXJuYW1lID0gYHN1cm5hbWUtJHtyYW5kb20oKX1gXHJcbiAgICAgICAgZW1haWwgPSBgZS0ke3JhbmRvbSgpfUBtYWlsLmNvbWBcclxuICAgICAgICBwYXNzd29yZCA9IGBwYXNzd29yZC0ke3JhbmRvbSgpfWBcclxuICAgICAgICBhZHJlc3MgPSBgc3RyZWV0LSR7cmFuZG9tKCl9YFxyXG4gICAgXHJcbiAgICAgICAgbmFtZVcgPSBgbmFtZS0ke3JhbmRvbSgpfWBcclxuICAgICAgICBzdXJuYW1lVyA9IGBzdXJuYW1lLSR7cmFuZG9tKCl9YFxyXG4gICAgICAgIGVtYWlsVyA9IGBlLSR7cmFuZG9tKCl9QG1haWwuY29tYFxyXG4gICAgICAgIHBhc3N3b3JkVyA9IGBwYXNzd29yZC0ke3JhbmRvbSgpfWBcclxuICAgICAgICBhZHJlc3NXID0gYHN0cmVldC0ke3JhbmRvbSgpfWBcclxuICAgICAgICBiYW5rQWNvdW50ID0gYGJhbmtBY291bnQtJHtyYW5kb20oKX1gXHJcbiAgICAgICAgcHJlc2VudGF0aW9uID0gYHByZXNlbnRhdGlvbi0ke3JhbmRvbSgpfWBcclxuICAgICAgICBkZXNjcmlwdGlvbiA9IGBkZXNjcmlwdGlvbi0ke3JhbmRvbSgpfWBcclxuICAgICAgICBwcmljaW5nSG91ciA9IHJhbmRvbSgpKjEwXHJcbiAgICAgICAgam9iQ2F0ZWdvcmllcyA9IGBqb2JDYXRlZ29yaWVzLSR7cmFuZG9tKCl9YFxyXG4gICAgICAgIHdvcmtpbmdEaXN0YW5jZSA9IHJhbmRvbSgpKjEwXHJcblxyXG4gICAgICAgIGNvbnN0IHdvcmtlciA9IGF3YWl0IFdvcmtlci5jcmVhdGUoe25hbWU6IG5hbWVXLCBzdXJuYW1lOiBzdXJuYW1lVywgZW1haWw6IGVtYWlsVywgcGFzc3dvcmQsIGFkcmVzcywgYWRyZXNzVywgYmFua0Fjb3VudCwgZGVzY3JpcHRpb24sIHByZXNlbnRhdGlvbiwgcHJpY2luZ0hvdXIsIGpvYkNhdGVnb3JpZXMsIHdvcmtpbmdEaXN0YW5jZX0pXHJcblxyXG4gICAgICAgIHdvcmtlcklkID0gd29ya2VyLmlkIFxyXG5cclxuICAgICAgICBjb25zdCBjaGF0ID0gYXdhaXQgQ2hhdC5jcmVhdGUoe1xyXG4gICAgICAgICAgICB1c2VyOiBPYmplY3RJZCh1c2VySWQpLCBcclxuICAgICAgICAgICAgd29ya2VyOiBPYmplY3RJZCh3b3JrZXJJZCksIFxyXG4gICAgICAgICAgICBkYXRlOiBuZXcgRGF0ZVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIG1lc3NhZ2UgPSAnaGVsbG8nICsgd29ya2VyLm5hbWVcclxuXHJcbiAgICAgICAgbmV3TWVzc2FnZSA9IGBtZXNzYWdlLSR7cmFuZG9tKCl9YFxyXG5cclxuICAgICAgICBjaGF0Lm1lc3NhZ2VzLnVuc2hpZnQoIG5ldyBDb21tZW50cyAoe1xyXG4gICAgICAgICAgICB1c2VySWQ6IE9iamVjdElkKHVzZXJJZCksXHJcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgICAgIHN1cm5hbWU6IHN1cm5hbWUsXHJcbiAgICAgICAgICAgIHRleHQ6IG1lc3NhZ2UsXHJcbiAgICAgICAgICAgIGRhdGU6IG5ldyBEYXRlXHJcbiAgICAgICAgfSkpXHJcblxyXG4gICAgICAgIGF3YWl0IGNoYXQuc2F2ZSgpXHJcblxyXG4gICAgICAgIGNoYXRJZCA9IGNoYXQuX2lkLnRvU3RyaW5nKClcclxuXHJcbiAgICB9KVxyXG4gICAgZGVzY3JpYmUoJ3VzZXIgZXhpc3RzJywgKCkgPT4ge1xyXG4gICAgICAgIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5jcmVhdGUoe25hbWUsIHN1cm5hbWUsIGVtYWlsLCBwYXNzd29yZCwgYWRyZXNzfSlcclxuXHJcbiAgICAgICAgICAgIHVzZXJJZCA9IHVzZXIuX2lkXHJcblxyXG4gICAgICAgICAgICByZXR1cm4gand0UHJvbWlzZWQuc2lnbih7IHN1YjogdXNlci5pZCB9LCBTRUNSRVQpXHJcbiAgICAgICAgICAgICAgICAudGhlbigodG9rZW4pID0+IGNvbnRleHQuc3RvcmFnZS50b2tlbiA9IHRva2VuKVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgc3VjY2VlZCBvbiBhZGRpbmcgbWVzc2FnZScsIGFzeW5jICgpID0+IHtcclxuXHJcbiAgICAgICAgICAgIGF3YWl0IGFkZE1lc3NhZ2UoY2hhdElkLCBuZXdNZXNzYWdlKVxyXG5cclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IENoYXQuZmluZCgpXHJcblxyXG4gICAgICAgICAgICBjb25zdCBbY2hhdF0gPSByZXN1bHRzXHJcblxyXG4gICAgICAgICAgICBleHBlY3QoY2hhdCkudG8uZXhpc3RcclxuICAgICAgICAgICAgZXhwZWN0KGNoYXQubWVzc2FnZXNbMF0udXNlcklkLnRvU3RyaW5nKCkpLnRvLmVxdWFsKHVzZXJJZC50b1N0cmluZygpKVxyXG4gICAgICAgICAgICBleHBlY3QoY2hhdC5tZXNzYWdlc1swXS50ZXh0KS50by5iZS5lcXVhbChuZXdNZXNzYWdlKVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGl0KCdzaG91bGQgc3VjY2VlZCBvbiBhZGRpbmcgY29tZW50JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICB0cnl7XHJcblxyXG4gICAgICAgICAgICAgICAgYXdhaXQgYWRkTWVzc2FnZShjaGF0SWQsIFwiXCIpXHJcblxyXG4gICAgICAgICAgICB9Y2F0Y2goe21lc3NhZ2V9KXtcclxuICAgICAgICAgICAgICAgIGV4cGVjdChtZXNzYWdlKS50by5leGlzdFxyXG4gICAgICAgICAgICAgICAgZXhwZWN0KG1lc3NhZ2UpLnRvLmVxdWFsKFwic3RyaW5nIGlzIGVtcHR5IG9yIGJsYW5rXCIpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBpdCgnc291bGQgZmFpbCB3aGVuIGNoYXQgaWQgZG9udCBleGlzdCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYWRkTWVzc2FnZSgnNWVlMGVkOWE2MDNhMGE0ZjNjNjUwZmUxJywgbmV3TWVzc2FnZSlcclxuICAgICAgICAgICAgICAgIC50aGVuKClcclxuICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGVycm9yKS50by5leGlzdFxyXG4gICAgICAgICAgICAgICAgICAgIGV4cGVjdChlcnJvci5tZXNzYWdlKS50by5lcXVhbChgY2hhdCB3aXRoIGlkIDVlZTBlZDlhNjAzYTBhNGYzYzY1MGZlMSBkb250IGV4aXN0c2ApXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICBcclxuICAgICAgICB9KVxyXG4gICAgfSlcclxuXHJcbiAgICBkZXNjcmliZSgnVXNlciBkb250IGV4aXN0cycsICgpID0+IHtcclxuICAgICAgICBsZXQgZmFrZUlkXHJcbiAgICAgICAgYmVmb3JlRWFjaChhc3luYygpID0+IHtcclxuICAgICAgICAgICAgZmFrZUlkID0gJzVlZTBlZDlhNjAzYTBhNGYzYzY1MGZlMSdcclxuICAgICAgICAgICAgcmV0dXJuIGp3dFByb21pc2VkLnNpZ24oeyBzdWI6IGZha2VJZCB9LCBTRUNSRVQpXHJcbiAgICAgICAgICAgICAgICAudGhlbigodG9rZW4pID0+IGNvbnRleHQuc3RvcmFnZS50b2tlbiA9IHRva2VuKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgaXQoJ3NvdWxkIGZhaWwgd2hlbiB1c2VyIGlkIGRvbnQgZXhpdHN0JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBhZGRNZXNzYWdlKGNoYXRJZCwgbmV3TWVzc2FnZSlcclxuICAgICAgICAgICAgICAgIC50aGVuKClcclxuICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXhwZWN0KGVycm9yKS50by5leGlzdFxyXG4gICAgICAgICAgICAgICAgICAgIGV4cGVjdChlcnJvci5tZXNzYWdlKS50by5lcXVhbChgdXNlciB3aXRoIGlkICR7ZmFrZUlkfSBkb250IGV4aXN0c2ApXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICBcclxuICAgICAgICB9KVxyXG4gICAgfSlcclxuXHJcbiAgICBhZnRlckVhY2goKCkgPT4gV29ya2VyLmRlbGV0ZU1hbnkoKSwgVXNlci5kZWxldGVNYW55KCksIENoYXQuZGVsZXRlTWFueSgpKVxyXG5cclxuICAgIGFmdGVyKG1vbmdvb3NlLmRpc2Nvbm5lY3QpXHJcbn0pIl19