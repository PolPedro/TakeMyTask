function cov_23ankjahai(){var path="C:\\Users\\polpe\\bootcamp\\collab\\skylab-bootcamp-202004\\staff\\pol-pedro\\takemytask\\takemytask-client-logic\\retrive-chats.spec.js";var hash="61e1a7d79f3d3a6e2429e1218f2606b4cea1d1d1";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\polpe\\bootcamp\\collab\\skylab-bootcamp-202004\\staff\\pol-pedro\\takemytask\\takemytask-client-logic\\retrive-chats.spec.js",statementMap:{"0":{start:{line:1,column:0},end:{line:1,column:26}},"1":{start:{line:3,column:96},end:{line:3,column:103}},"2":{start:{line:5,column:21},end:{line:5,column:47}},"3":{start:{line:6,column:19},end:{line:6,column:23}},"4":{start:{line:7,column:19},end:{line:7,column:34}},"5":{start:{line:8,column:0},end:{line:8,column:44}},"6":{start:{line:9,column:35},end:{line:9,column:64}},"7":{start:{line:10,column:85},end:{line:10,column:111}},"8":{start:{line:11,column:15},end:{line:11,column:34}},"9":{start:{line:12,column:0},end:{line:12,column:43}},"10":{start:{line:13,column:16},end:{line:13,column:36}},"11":{start:{line:15,column:0},end:{line:15,column:25}},"12":{start:{line:17,column:0},end:{line:17,column:20}},"13":{start:{line:19,column:0},end:{line:118,column:2}},"14":{start:{line:20,column:4},end:{line:20,column:47}},"15":{start:{line:20,column:17},end:{line:20,column:46}},"16":{start:{line:24,column:4},end:{line:81,column:6}},"17":{start:{line:25,column:8},end:{line:25,column:31}},"18":{start:{line:26,column:8},end:{line:26,column:33}},"19":{start:{line:27,column:8},end:{line:27,column:31}},"20":{start:{line:29,column:8},end:{line:29,column:33}},"21":{start:{line:30,column:8},end:{line:30,column:39}},"22":{start:{line:31,column:8},end:{line:31,column:40}},"23":{start:{line:32,column:8},end:{line:32,column:41}},"24":{start:{line:33,column:8},end:{line:33,column:37}},"25":{start:{line:35,column:21},end:{line:35,column:52}},"26":{start:{line:37,column:21},end:{line:37,column:86}},"27":{start:{line:39,column:8},end:{line:40,column:59}},"28":{start:{line:40,column:29},end:{line:40,column:58}},"29":{start:{line:42,column:8},end:{line:42,column:24}},"30":{start:{line:44,column:8},end:{line:44,column:34}},"31":{start:{line:45,column:8},end:{line:45,column:40}},"32":{start:{line:46,column:8},end:{line:46,column:41}},"33":{start:{line:47,column:8},end:{line:47,column:42}},"34":{start:{line:48,column:8},end:{line:48,column:38}},"35":{start:{line:49,column:8},end:{line:49,column:45}},"36":{start:{line:50,column:8},end:{line:50,column:47}},"37":{start:{line:51,column:8},end:{line:51,column:33}},"38":{start:{line:52,column:8},end:{line:52,column:51}},"39":{start:{line:53,column:8},end:{line:53,column:37}},"40":{start:{line:55,column:22},end:{line:55,column:53}},"41":{start:{line:57,column:23},end:{line:57,column:195}},"42":{start:{line:59,column:8},end:{line:59,column:28}},"43":{start:{line:61,column:21},end:{line:65,column:10}},"44":{start:{line:67,column:8},end:{line:67,column:39}},"45":{start:{line:69,column:8},end:{line:75,column:11}},"46":{start:{line:77,column:8},end:{line:77,column:25}},"47":{start:{line:79,column:8},end:{line:79,column:36}},"48":{start:{line:83,column:4},end:{line:94,column:6}},"49":{start:{line:84,column:23},end:{line:84,column:43}},"50":{start:{line:86,column:8},end:{line:86,column:31}},"51":{start:{line:91,column:8},end:{line:91,column:57}},"52":{start:{line:92,column:8},end:{line:92,column:63}},"53":{start:{line:93,column:8},end:{line:93,column:60}},"54":{start:{line:96,column:4},end:{line:113,column:6}},"55":{start:{line:98,column:8},end:{line:102,column:10}},"56":{start:{line:99,column:12},end:{line:99,column:47}},"57":{start:{line:100,column:12},end:{line:101,column:63}},"58":{start:{line:101,column:33},end:{line:101,column:62}},"59":{start:{line:103,column:8},end:{line:112,column:10}},"60":{start:{line:105,column:27},end:{line:110,column:18}},"61":{start:{line:108,column:20},end:{line:108,column:42}},"62":{start:{line:109,column:20},end:{line:109,column:104}},"63":{start:{line:115,column:4},end:{line:115,column:78}},"64":{start:{line:115,column:20},end:{line:115,column:39}},"65":{start:{line:117,column:4},end:{line:117,column:30}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:19,column:34},end:{line:19,column:35}},loc:{start:{line:19,column:40},end:{line:118,column:1}},line:19},"1":{name:"(anonymous_1)",decl:{start:{line:20,column:11},end:{line:20,column:12}},loc:{start:{line:20,column:17},end:{line:20,column:46}},line:20},"2":{name:"(anonymous_2)",decl:{start:{line:24,column:15},end:{line:24,column:16}},loc:{start:{line:24,column:27},end:{line:81,column:5}},line:24},"3":{name:"(anonymous_3)",decl:{start:{line:40,column:18},end:{line:40,column:19}},loc:{start:{line:40,column:29},end:{line:40,column:58}},line:40},"4":{name:"(anonymous_4)",decl:{start:{line:83,column:39},end:{line:83,column:40}},loc:{start:{line:83,column:51},end:{line:94,column:5}},line:83},"5":{name:"(anonymous_5)",decl:{start:{line:96,column:33},end:{line:96,column:34}},loc:{start:{line:96,column:39},end:{line:113,column:5}},line:96},"6":{name:"(anonymous_6)",decl:{start:{line:98,column:19},end:{line:98,column:20}},loc:{start:{line:98,column:30},end:{line:102,column:9}},line:98},"7":{name:"(anonymous_7)",decl:{start:{line:101,column:22},end:{line:101,column:23}},loc:{start:{line:101,column:33},end:{line:101,column:62}},line:101},"8":{name:"(anonymous_8)",decl:{start:{line:103,column:50},end:{line:103,column:51}},loc:{start:{line:103,column:62},end:{line:112,column:9}},line:103},"9":{name:"(anonymous_9)",decl:{start:{line:107,column:23},end:{line:107,column:24}},loc:{start:{line:107,column:32},end:{line:110,column:17}},line:107},"10":{name:"(anonymous_10)",decl:{start:{line:115,column:14},end:{line:115,column:15}},loc:{start:{line:115,column:20},end:{line:115,column:39}},line:115}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"61e1a7d79f3d3a6e2429e1218f2606b4cea1d1d1"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_23ankjahai=function(){return actualCoverage;};}return actualCoverage;}cov_23ankjahai();cov_23ankjahai().s[0]++;require('dotenv').config();const{env:{TEST_MONGODB_URL:MONGODB_URL,TEST_SECRET:SECRET,TEST_API_URL:API_URL}}=(cov_23ankjahai().s[1]++,process);const retriveChats=(cov_23ankjahai().s[2]++,require('./retrive-chats'));const{random}=(cov_23ankjahai().s[3]++,Math);const{expect}=(cov_23ankjahai().s[4]++,require('chai'));cov_23ankjahai().s[5]++;require('takemytask-commons/polyfills/json');const{utils:{jwtPromised}}=(cov_23ankjahai().s[6]++,require('takemytask-commons'));const{mongoose,models:{Chat,User,Worker,Comments},mongoose:{ObjectId}}=(cov_23ankjahai().s[7]++,require('takemytask-data'));const bcrypt=(cov_23ankjahai().s[8]++,require('bcryptjs'));cov_23ankjahai().s[9]++;require('takemytask-commons/ponyfills/xhr');const context=(cov_23ankjahai().s[10]++,require('./context'));cov_23ankjahai().s[11]++;context.API_URL=API_URL;cov_23ankjahai().s[12]++;context.storage={};cov_23ankjahai().s[13]++;describe('logic - retrive chats',()=>{cov_23ankjahai().f[0]++;cov_23ankjahai().s[14]++;before(()=>{cov_23ankjahai().f[1]++;cov_23ankjahai().s[15]++;return mongoose.connect(MONGODB_URL);});let name,surname,email,password,adress,bankAcount,description,pricingHour,jobCategories,workingDistance,workerId,userId,chatId,message;cov_23ankjahai().s[16]++;beforeEach(async()=>{cov_23ankjahai().f[2]++;cov_23ankjahai().s[17]++;await User.deleteMany();cov_23ankjahai().s[18]++;await Worker.deleteMany();cov_23ankjahai().s[19]++;await Chat.deleteMany();cov_23ankjahai().s[20]++;name=`name-${random()}`;cov_23ankjahai().s[21]++;surname=`surname-${random()}`;cov_23ankjahai().s[22]++;email=`e-${random()}@mail.com`;cov_23ankjahai().s[23]++;password=`password-${random()}`;cov_23ankjahai().s[24]++;adress=`street-${random()}`;const hash=(cov_23ankjahai().s[25]++,await bcrypt.hash(password,10));const user=(cov_23ankjahai().s[26]++,await User.create({name,surname,email,password:hash,adress}));cov_23ankjahai().s[27]++;jwtPromised.sign({sub:user.id},SECRET).then(token=>{cov_23ankjahai().f[3]++;cov_23ankjahai().s[28]++;return context.storage.token=token;});cov_23ankjahai().s[29]++;userId=user.id;cov_23ankjahai().s[30]++;nameW=`name-${random()}`;cov_23ankjahai().s[31]++;surnameW=`surname-${random()}`;cov_23ankjahai().s[32]++;emailW=`e-${random()}@mail.com`;cov_23ankjahai().s[33]++;passwordW=`password-${random()}`;cov_23ankjahai().s[34]++;adressW=`street-${random()}`;cov_23ankjahai().s[35]++;bankAcount=`bankAcount-${random()}`;cov_23ankjahai().s[36]++;description=`description-${random()}`;cov_23ankjahai().s[37]++;pricingHour=random()*10;cov_23ankjahai().s[38]++;jobCategories=`jobCategories-${random()}`;cov_23ankjahai().s[39]++;workingDistance=random()*10;const hashW=(cov_23ankjahai().s[40]++,await bcrypt.hash(password,10));const worker=(cov_23ankjahai().s[41]++,await Worker.create({name:nameW,surname:surnameW,email:emailW,password:hashW,adress,adressW,bankAcount,description,pricingHour,jobCategories,workingDistance}));cov_23ankjahai().s[42]++;workerId=worker.id;const chat=(cov_23ankjahai().s[43]++,await Chat.create({user:ObjectId(userId),worker:ObjectId(workerId),date:new Date()}));cov_23ankjahai().s[44]++;message='hello'+worker.name;cov_23ankjahai().s[45]++;chat.messages.unshift(new Comments({userId:ObjectId(userId),name:name,surname:surname,text:message,date:new Date()}));cov_23ankjahai().s[46]++;await chat.save();cov_23ankjahai().s[47]++;chatId=chat._id.toString();});cov_23ankjahai().s[48]++;it('should succeed on valid data',async()=>{cov_23ankjahai().f[4]++;const result=(cov_23ankjahai().s[49]++,await retriveChats());cov_23ankjahai().s[50]++;expect(result).to.exist;// expect(result[0]._id.toString()).to.equal(chatId)
// expect(result[0].user.toString()).to.equal(userId.toString())
// expect(result[0].worker.toString()).to.equal(workerId.toString())
cov_23ankjahai().s[51]++;expect(result[0].messages[0].name).to.equal(name);cov_23ankjahai().s[52]++;expect(result[0].messages[0].surname).to.equal(surname);cov_23ankjahai().s[53]++;expect(result[0].messages[0].text).to.equal(message);});cov_23ankjahai().s[54]++;describe('chat dont exists',()=>{cov_23ankjahai().f[5]++;let fakeId;cov_23ankjahai().s[55]++;beforeEach(async()=>{cov_23ankjahai().f[6]++;cov_23ankjahai().s[56]++;fakeId='5ee0ed9a603a0a4f3c650fe1';cov_23ankjahai().s[57]++;return jwtPromised.sign({sub:fakeId},SECRET).then(token=>{cov_23ankjahai().f[7]++;cov_23ankjahai().s[58]++;return context.storage.token=token;});});cov_23ankjahai().s[59]++;it('sould fail when user id has no chat',async()=>{cov_23ankjahai().f[8]++;const result=(cov_23ankjahai().s[60]++,await retriveChats().then().catch(error=>{cov_23ankjahai().f[9]++;cov_23ankjahai().s[61]++;expect(error).to.exist;cov_23ankjahai().s[62]++;expect(error.message).to.equal(`user with id: 5ee0ed9a603a0a4f3c650fe1 dont exists`);}));});});cov_23ankjahai().s[63]++;afterEach(()=>{cov_23ankjahai().f[10]++;cov_23ankjahai().s[64]++;return Worker.deleteMany();},User.deleteMany(),Chat.deleteMany());cov_23ankjahai().s[65]++;after(mongoose.disconnect);});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJldHJpdmUtY2hhdHMuc3BlYy5qcyJdLCJuYW1lcyI6WyJyZXF1aXJlIiwiY29uZmlnIiwiZW52IiwiVEVTVF9NT05HT0RCX1VSTCIsIk1PTkdPREJfVVJMIiwiVEVTVF9TRUNSRVQiLCJTRUNSRVQiLCJURVNUX0FQSV9VUkwiLCJBUElfVVJMIiwicHJvY2VzcyIsInJldHJpdmVDaGF0cyIsInJhbmRvbSIsIk1hdGgiLCJleHBlY3QiLCJ1dGlscyIsImp3dFByb21pc2VkIiwibW9uZ29vc2UiLCJtb2RlbHMiLCJDaGF0IiwiVXNlciIsIldvcmtlciIsIkNvbW1lbnRzIiwiT2JqZWN0SWQiLCJiY3J5cHQiLCJjb250ZXh0Iiwic3RvcmFnZSIsImRlc2NyaWJlIiwiYmVmb3JlIiwiY29ubmVjdCIsIm5hbWUiLCJzdXJuYW1lIiwiZW1haWwiLCJwYXNzd29yZCIsImFkcmVzcyIsImJhbmtBY291bnQiLCJkZXNjcmlwdGlvbiIsInByaWNpbmdIb3VyIiwiam9iQ2F0ZWdvcmllcyIsIndvcmtpbmdEaXN0YW5jZSIsIndvcmtlcklkIiwidXNlcklkIiwiY2hhdElkIiwibWVzc2FnZSIsImJlZm9yZUVhY2giLCJkZWxldGVNYW55IiwiaGFzaCIsInVzZXIiLCJjcmVhdGUiLCJzaWduIiwic3ViIiwiaWQiLCJ0aGVuIiwidG9rZW4iLCJuYW1lVyIsInN1cm5hbWVXIiwiZW1haWxXIiwicGFzc3dvcmRXIiwiYWRyZXNzVyIsImhhc2hXIiwid29ya2VyIiwiY2hhdCIsImRhdGUiLCJEYXRlIiwibWVzc2FnZXMiLCJ1bnNoaWZ0IiwidGV4dCIsInNhdmUiLCJfaWQiLCJ0b1N0cmluZyIsIml0IiwicmVzdWx0IiwidG8iLCJleGlzdCIsImVxdWFsIiwiZmFrZUlkIiwiY2F0Y2giLCJlcnJvciIsImFmdGVyRWFjaCIsImFmdGVyIiwiZGlzY29ubmVjdCJdLCJtYXBwaW5ncyI6InMvTUFlWTttSEFmWkEsT0FBTyxDQUFDLFFBQUQsQ0FBUCxDQUFrQkMsTUFBbEIsR0FFQSxL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QUFLLEVBQUksa0RBQ1ovRCxNQUFNLENBQUMrRCxLQUFELENBQU4sQ0FBY0wsRUFBZCxDQUFpQkMsS0FBakIsQ0FEWSx5QkFFWjNELE1BQU0sQ0FBQytELEtBQUssQ0FBQ2xDLE9BQVAsQ0FBTixDQUFzQjZCLEVBQXRCLENBQXlCRSxLQUF6QixDQUFnQyxvREFBaEMsRUFDSCxDQUxnQixDQUFULENBQVosQ0FPSCxDQVRDLENBQUYsQ0FVSCxDQWpCTyxDQUFSLENBN0VvQyx5QkFnR3BDSSxTQUFTLENBQUMsSUFBTSx5REFBQXpELENBQUFBLE1BQU0sQ0FBQ3dCLFVBQVAsR0FBbUIsQ0FBMUIsQ0FBNEJ6QixJQUFJLENBQUN5QixVQUFMLEVBQTVCLENBQStDMUIsSUFBSSxDQUFDMEIsVUFBTCxFQUEvQyxDQUFULENBaEdvQyx5QkFrR3BDa0MsS0FBSyxDQUFDOUQsUUFBUSxDQUFDK0QsVUFBVixDQUFMLENBQ0gsQ0FuR08sQ0FBUiIsInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJ2RvdGVudicpLmNvbmZpZygpXHJcblxyXG5jb25zdCB7IGVudjogeyBURVNUX01PTkdPREJfVVJMOiBNT05HT0RCX1VSTCwgVEVTVF9TRUNSRVQ6IFNFQ1JFVCwgVEVTVF9BUElfVVJMOiBBUElfVVJMICB9IH0gPSBwcm9jZXNzXHJcblxyXG5jb25zdCByZXRyaXZlQ2hhdHMgPSByZXF1aXJlKCcuL3JldHJpdmUtY2hhdHMnKVxyXG5jb25zdCB7IHJhbmRvbSB9ID0gTWF0aFxyXG5jb25zdCB7IGV4cGVjdCB9ID0gcmVxdWlyZSgnY2hhaScpXHJcbnJlcXVpcmUoJ3Rha2VteXRhc2stY29tbW9ucy9wb2x5ZmlsbHMvanNvbicpXHJcbmNvbnN0IHsgdXRpbHM6IHsgand0UHJvbWlzZWQgfSB9ID0gcmVxdWlyZSgndGFrZW15dGFzay1jb21tb25zJylcclxuY29uc3QgeyBtb25nb29zZSwgbW9kZWxzOiB7IENoYXQsIFVzZXIsIFdvcmtlciwgQ29tbWVudHMgfSwgbW9uZ29vc2U6IHtPYmplY3RJZH0gfSA9IHJlcXVpcmUoJ3Rha2VteXRhc2stZGF0YScpXHJcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdGpzJylcclxucmVxdWlyZSgndGFrZW15dGFzay1jb21tb25zL3BvbnlmaWxscy94aHInKVxyXG5jb25zdCBjb250ZXh0ID0gcmVxdWlyZSgnLi9jb250ZXh0JylcclxuXHJcbmNvbnRleHQuQVBJX1VSTCA9IEFQSV9VUkxcclxuXHJcbmNvbnRleHQuc3RvcmFnZSA9IHt9XHJcblxyXG5kZXNjcmliZSgnbG9naWMgLSByZXRyaXZlIGNoYXRzJywgKCkgPT4ge1xyXG4gICAgYmVmb3JlKCgpID0+IG1vbmdvb3NlLmNvbm5lY3QoTU9OR09EQl9VUkwpKVxyXG5cclxuICAgIGxldCBuYW1lLCBzdXJuYW1lLCBlbWFpbCwgcGFzc3dvcmQsIGFkcmVzcywgYmFua0Fjb3VudCwgZGVzY3JpcHRpb24sIHByaWNpbmdIb3VyLCBqb2JDYXRlZ29yaWVzLCB3b3JraW5nRGlzdGFuY2UsIHdvcmtlcklkLCB1c2VySWQsIGNoYXRJZCwgbWVzc2FnZVxyXG5cclxuICAgIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIGF3YWl0IFVzZXIuZGVsZXRlTWFueSgpXHJcbiAgICAgICAgYXdhaXQgV29ya2VyLmRlbGV0ZU1hbnkoKVxyXG4gICAgICAgIGF3YWl0IENoYXQuZGVsZXRlTWFueSgpXHJcblxyXG4gICAgICAgIG5hbWUgPSBgbmFtZS0ke3JhbmRvbSgpfWBcclxuICAgICAgICBzdXJuYW1lID0gYHN1cm5hbWUtJHtyYW5kb20oKX1gXHJcbiAgICAgICAgZW1haWwgPSBgZS0ke3JhbmRvbSgpfUBtYWlsLmNvbWBcclxuICAgICAgICBwYXNzd29yZCA9IGBwYXNzd29yZC0ke3JhbmRvbSgpfWBcclxuICAgICAgICBhZHJlc3MgPSBgc3RyZWV0LSR7cmFuZG9tKCl9YFxyXG5cclxuICAgICAgICBjb25zdCBoYXNoID0gYXdhaXQgYmNyeXB0Lmhhc2gocGFzc3dvcmQsIDEwKVxyXG5cclxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5jcmVhdGUoe25hbWUsIHN1cm5hbWUsIGVtYWlsLCBwYXNzd29yZDogaGFzaCwgYWRyZXNzfSlcclxuICAgICAgICBcclxuICAgICAgICBqd3RQcm9taXNlZC5zaWduKHsgc3ViOiB1c2VyLmlkIH0sIFNFQ1JFVClcclxuICAgICAgICAgICAgLnRoZW4oKHRva2VuKSA9PiBjb250ZXh0LnN0b3JhZ2UudG9rZW4gPSB0b2tlbilcclxuICAgICAgICBcclxuICAgICAgICB1c2VySWQgPSB1c2VyLmlkXHJcbiAgICBcclxuICAgICAgICBuYW1lVyA9IGBuYW1lLSR7cmFuZG9tKCl9YFxyXG4gICAgICAgIHN1cm5hbWVXID0gYHN1cm5hbWUtJHtyYW5kb20oKX1gXHJcbiAgICAgICAgZW1haWxXID0gYGUtJHtyYW5kb20oKX1AbWFpbC5jb21gXHJcbiAgICAgICAgcGFzc3dvcmRXID0gYHBhc3N3b3JkLSR7cmFuZG9tKCl9YFxyXG4gICAgICAgIGFkcmVzc1cgPSBgc3RyZWV0LSR7cmFuZG9tKCl9YFxyXG4gICAgICAgIGJhbmtBY291bnQgPSBgYmFua0Fjb3VudC0ke3JhbmRvbSgpfWBcclxuICAgICAgICBkZXNjcmlwdGlvbiA9IGBkZXNjcmlwdGlvbi0ke3JhbmRvbSgpfWBcclxuICAgICAgICBwcmljaW5nSG91ciA9IHJhbmRvbSgpKjEwXHJcbiAgICAgICAgam9iQ2F0ZWdvcmllcyA9IGBqb2JDYXRlZ29yaWVzLSR7cmFuZG9tKCl9YFxyXG4gICAgICAgIHdvcmtpbmdEaXN0YW5jZSA9IHJhbmRvbSgpKjEwXHJcblxyXG4gICAgICAgIGNvbnN0IGhhc2hXID0gYXdhaXQgYmNyeXB0Lmhhc2gocGFzc3dvcmQsIDEwKVxyXG5cclxuICAgICAgICBjb25zdCB3b3JrZXIgPSBhd2FpdCBXb3JrZXIuY3JlYXRlKHtuYW1lOiBuYW1lVywgc3VybmFtZTogc3VybmFtZVcsIGVtYWlsOiBlbWFpbFcsIHBhc3N3b3JkOiBoYXNoVywgYWRyZXNzLCBhZHJlc3NXLCBiYW5rQWNvdW50LCBkZXNjcmlwdGlvbiwgcHJpY2luZ0hvdXIsIGpvYkNhdGVnb3JpZXMsIHdvcmtpbmdEaXN0YW5jZX0pXHJcblxyXG4gICAgICAgIHdvcmtlcklkID0gd29ya2VyLmlkIFxyXG5cclxuICAgICAgICBjb25zdCBjaGF0ID0gYXdhaXQgQ2hhdC5jcmVhdGUoe1xyXG4gICAgICAgICAgICB1c2VyOiBPYmplY3RJZCh1c2VySWQpLCBcclxuICAgICAgICAgICAgd29ya2VyOiBPYmplY3RJZCh3b3JrZXJJZCksIFxyXG4gICAgICAgICAgICBkYXRlOiBuZXcgRGF0ZVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIG1lc3NhZ2UgPSAnaGVsbG8nICsgd29ya2VyLm5hbWVcclxuXHJcbiAgICAgICAgY2hhdC5tZXNzYWdlcy51bnNoaWZ0KCBuZXcgQ29tbWVudHMgKHtcclxuICAgICAgICAgICAgdXNlcklkOiBPYmplY3RJZCh1c2VySWQpLFxyXG4gICAgICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgICAgICBzdXJuYW1lOiBzdXJuYW1lLFxyXG4gICAgICAgICAgICB0ZXh0OiBtZXNzYWdlLFxyXG4gICAgICAgICAgICBkYXRlOiBuZXcgRGF0ZVxyXG4gICAgICAgIH0pKVxyXG5cclxuICAgICAgICBhd2FpdCBjaGF0LnNhdmUoKVxyXG5cclxuICAgICAgICBjaGF0SWQgPSBjaGF0Ll9pZC50b1N0cmluZygpXHJcblxyXG4gICAgfSlcclxuXHJcbiAgICBpdCgnc2hvdWxkIHN1Y2NlZWQgb24gdmFsaWQgZGF0YScsIGFzeW5jICgpID0+IHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXRyaXZlQ2hhdHMoKVxyXG5cclxuICAgICAgICBleHBlY3QocmVzdWx0KS50by5leGlzdFxyXG5cclxuICAgICAgICAvLyBleHBlY3QocmVzdWx0WzBdLl9pZC50b1N0cmluZygpKS50by5lcXVhbChjaGF0SWQpXHJcbiAgICAgICAgLy8gZXhwZWN0KHJlc3VsdFswXS51c2VyLnRvU3RyaW5nKCkpLnRvLmVxdWFsKHVzZXJJZC50b1N0cmluZygpKVxyXG4gICAgICAgIC8vIGV4cGVjdChyZXN1bHRbMF0ud29ya2VyLnRvU3RyaW5nKCkpLnRvLmVxdWFsKHdvcmtlcklkLnRvU3RyaW5nKCkpXHJcbiAgICAgICAgZXhwZWN0KHJlc3VsdFswXS5tZXNzYWdlc1swXS5uYW1lKS50by5lcXVhbChuYW1lKVxyXG4gICAgICAgIGV4cGVjdChyZXN1bHRbMF0ubWVzc2FnZXNbMF0uc3VybmFtZSkudG8uZXF1YWwoc3VybmFtZSlcclxuICAgICAgICBleHBlY3QocmVzdWx0WzBdLm1lc3NhZ2VzWzBdLnRleHQpLnRvLmVxdWFsKG1lc3NhZ2UpXHJcbiAgICB9KVxyXG5cclxuICAgIGRlc2NyaWJlKCdjaGF0IGRvbnQgZXhpc3RzJywgKCkgPT4ge1xyXG4gICAgICAgIGxldCBmYWtlSWRcclxuICAgICAgICBiZWZvcmVFYWNoKGFzeW5jKCkgPT4ge1xyXG4gICAgICAgICAgICBmYWtlSWQgPSAnNWVlMGVkOWE2MDNhMGE0ZjNjNjUwZmUxJ1xyXG4gICAgICAgICAgICByZXR1cm4gand0UHJvbWlzZWQuc2lnbih7IHN1YjogZmFrZUlkIH0sIFNFQ1JFVClcclxuICAgICAgICAgICAgICAgIC50aGVuKCh0b2tlbikgPT4gY29udGV4dC5zdG9yYWdlLnRva2VuID0gdG9rZW4pXHJcbiAgICAgICAgfSlcclxuICAgICAgICBpdCgnc291bGQgZmFpbCB3aGVuIHVzZXIgaWQgaGFzIG5vIGNoYXQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJldHJpdmVDaGF0cygpXHJcbiAgICAgICAgICAgICAgICAudGhlbigpXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGV4cGVjdChlcnJvcikudG8uZXhpc3RcclxuICAgICAgICAgICAgICAgICAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG8uZXF1YWwoYHVzZXIgd2l0aCBpZDogNWVlMGVkOWE2MDNhMGE0ZjNjNjUwZmUxIGRvbnQgZXhpc3RzYClcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG5cclxuICAgIGFmdGVyRWFjaCgoKSA9PiBXb3JrZXIuZGVsZXRlTWFueSgpLCBVc2VyLmRlbGV0ZU1hbnkoKSwgQ2hhdC5kZWxldGVNYW55KCkpXHJcblxyXG4gICAgYWZ0ZXIobW9uZ29vc2UuZGlzY29ubmVjdClcclxufSkiXX0=