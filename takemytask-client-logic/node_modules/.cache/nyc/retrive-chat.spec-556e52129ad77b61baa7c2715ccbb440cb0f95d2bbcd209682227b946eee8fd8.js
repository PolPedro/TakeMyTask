function cov_2d9zcv67i8(){var path="C:\\Users\\polpe\\bootcamp\\collab\\skylab-bootcamp-202004\\staff\\pol-pedro\\takemytask\\takemytask-client-logic\\retrive-chat.spec.js";var hash="2cdc49f0d28e1dc8398c35438c6a0a278d3d5ffe";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\polpe\\bootcamp\\collab\\skylab-bootcamp-202004\\staff\\pol-pedro\\takemytask\\takemytask-client-logic\\retrive-chat.spec.js",statementMap:{"0":{start:{line:1,column:0},end:{line:1,column:26}},"1":{start:{line:3,column:96},end:{line:3,column:103}},"2":{start:{line:5,column:20},end:{line:5,column:45}},"3":{start:{line:6,column:19},end:{line:6,column:23}},"4":{start:{line:7,column:19},end:{line:7,column:34}},"5":{start:{line:8,column:0},end:{line:8,column:44}},"6":{start:{line:9,column:35},end:{line:9,column:64}},"7":{start:{line:10,column:85},end:{line:10,column:111}},"8":{start:{line:11,column:15},end:{line:11,column:34}},"9":{start:{line:12,column:0},end:{line:12,column:43}},"10":{start:{line:13,column:16},end:{line:13,column:36}},"11":{start:{line:15,column:0},end:{line:15,column:25}},"12":{start:{line:17,column:0},end:{line:17,column:20}},"13":{start:{line:19,column:0},end:{line:137,column:2}},"14":{start:{line:20,column:4},end:{line:20,column:47}},"15":{start:{line:20,column:17},end:{line:20,column:46}},"16":{start:{line:24,column:4},end:{line:81,column:6}},"17":{start:{line:25,column:8},end:{line:25,column:31}},"18":{start:{line:26,column:8},end:{line:26,column:33}},"19":{start:{line:27,column:8},end:{line:27,column:31}},"20":{start:{line:29,column:8},end:{line:29,column:33}},"21":{start:{line:30,column:8},end:{line:30,column:39}},"22":{start:{line:31,column:8},end:{line:31,column:40}},"23":{start:{line:32,column:8},end:{line:32,column:41}},"24":{start:{line:33,column:8},end:{line:33,column:37}},"25":{start:{line:35,column:21},end:{line:35,column:52}},"26":{start:{line:37,column:21},end:{line:37,column:86}},"27":{start:{line:39,column:8},end:{line:40,column:59}},"28":{start:{line:40,column:29},end:{line:40,column:58}},"29":{start:{line:42,column:8},end:{line:42,column:24}},"30":{start:{line:44,column:8},end:{line:44,column:34}},"31":{start:{line:45,column:8},end:{line:45,column:40}},"32":{start:{line:46,column:8},end:{line:46,column:41}},"33":{start:{line:47,column:8},end:{line:47,column:42}},"34":{start:{line:48,column:8},end:{line:48,column:38}},"35":{start:{line:49,column:8},end:{line:49,column:45}},"36":{start:{line:50,column:8},end:{line:50,column:47}},"37":{start:{line:51,column:8},end:{line:51,column:33}},"38":{start:{line:52,column:8},end:{line:52,column:51}},"39":{start:{line:53,column:8},end:{line:53,column:37}},"40":{start:{line:55,column:22},end:{line:55,column:53}},"41":{start:{line:57,column:23},end:{line:57,column:195}},"42":{start:{line:59,column:8},end:{line:59,column:28}},"43":{start:{line:61,column:21},end:{line:65,column:10}},"44":{start:{line:67,column:8},end:{line:67,column:39}},"45":{start:{line:69,column:8},end:{line:75,column:11}},"46":{start:{line:77,column:8},end:{line:77,column:25}},"47":{start:{line:79,column:8},end:{line:79,column:25}},"48":{start:{line:83,column:4},end:{line:93,column:6}},"49":{start:{line:84,column:23},end:{line:84,column:48}},"50":{start:{line:86,column:8},end:{line:86,column:31}},"51":{start:{line:88,column:8},end:{line:88,column:66}},"52":{start:{line:89,column:8},end:{line:89,column:70}},"53":{start:{line:90,column:8},end:{line:90,column:54}},"54":{start:{line:91,column:8},end:{line:91,column:60}},"55":{start:{line:92,column:8},end:{line:92,column:57}},"56":{start:{line:95,column:4},end:{line:102,column:6}},"57":{start:{line:96,column:8},end:{line:101,column:9}},"58":{start:{line:97,column:27},end:{line:97,column:48}},"59":{start:{line:99,column:12},end:{line:99,column:36}},"60":{start:{line:100,column:12},end:{line:100,column:64}},"61":{start:{line:104,column:4},end:{line:113,column:6}},"62":{start:{line:106,column:23},end:{line:111,column:14}},"63":{start:{line:109,column:16},end:{line:109,column:38}},"64":{start:{line:110,column:16},end:{line:110,column:100}},"65":{start:{line:134,column:4},end:{line:134,column:40}},"66":{start:{line:134,column:20},end:{line:134,column:39}},"67":{start:{line:136,column:4},end:{line:136,column:30}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:19,column:31},end:{line:19,column:32}},loc:{start:{line:19,column:37},end:{line:137,column:1}},line:19},"1":{name:"(anonymous_1)",decl:{start:{line:20,column:11},end:{line:20,column:12}},loc:{start:{line:20,column:17},end:{line:20,column:46}},line:20},"2":{name:"(anonymous_2)",decl:{start:{line:24,column:15},end:{line:24,column:16}},loc:{start:{line:24,column:27},end:{line:81,column:5}},line:24},"3":{name:"(anonymous_3)",decl:{start:{line:40,column:18},end:{line:40,column:19}},loc:{start:{line:40,column:29},end:{line:40,column:58}},line:40},"4":{name:"(anonymous_4)",decl:{start:{line:83,column:39},end:{line:83,column:40}},loc:{start:{line:83,column:51},end:{line:93,column:5}},line:83},"5":{name:"(anonymous_5)",decl:{start:{line:95,column:40},end:{line:95,column:41}},loc:{start:{line:95,column:52},end:{line:102,column:5}},line:95},"6":{name:"(anonymous_6)",decl:{start:{line:104,column:53},end:{line:104,column:54}},loc:{start:{line:104,column:65},end:{line:113,column:5}},line:104},"7":{name:"(anonymous_7)",decl:{start:{line:108,column:19},end:{line:108,column:20}},loc:{start:{line:108,column:28},end:{line:111,column:13}},line:108},"8":{name:"(anonymous_8)",decl:{start:{line:134,column:14},end:{line:134,column:15}},loc:{start:{line:134,column:20},end:{line:134,column:39}},line:134}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"2cdc49f0d28e1dc8398c35438c6a0a278d3d5ffe"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2d9zcv67i8=function(){return actualCoverage;};}return actualCoverage;}cov_2d9zcv67i8();cov_2d9zcv67i8().s[0]++;require('dotenv').config();const{env:{TEST_MONGODB_URL:MONGODB_URL,TEST_SECRET:SECRET,TEST_API_URL:API_URL}}=(cov_2d9zcv67i8().s[1]++,process);const retriveChat=(cov_2d9zcv67i8().s[2]++,require('./retrive-chat'));const{random}=(cov_2d9zcv67i8().s[3]++,Math);const{expect}=(cov_2d9zcv67i8().s[4]++,require('chai'));cov_2d9zcv67i8().s[5]++;require('takemytask-commons/polyfills/json');const{utils:{jwtPromised}}=(cov_2d9zcv67i8().s[6]++,require('takemytask-commons'));const{mongoose,models:{Chat,User,Worker,Comments},mongoose:{ObjectId}}=(cov_2d9zcv67i8().s[7]++,require('takemytask-data'));const bcrypt=(cov_2d9zcv67i8().s[8]++,require('bcryptjs'));cov_2d9zcv67i8().s[9]++;require('takemytask-commons/ponyfills/xhr');const context=(cov_2d9zcv67i8().s[10]++,require('./context'));cov_2d9zcv67i8().s[11]++;context.API_URL=API_URL;cov_2d9zcv67i8().s[12]++;context.storage={};cov_2d9zcv67i8().s[13]++;describe('logic - creat chat',()=>{cov_2d9zcv67i8().f[0]++;cov_2d9zcv67i8().s[14]++;before(()=>{cov_2d9zcv67i8().f[1]++;cov_2d9zcv67i8().s[15]++;return mongoose.connect(MONGODB_URL);});let name,surname,email,password,adress,bankAcount,description,pricingHour,jobCategories,workingDistance,workerId,userId,chatId,message;cov_2d9zcv67i8().s[16]++;beforeEach(async()=>{cov_2d9zcv67i8().f[2]++;cov_2d9zcv67i8().s[17]++;await User.deleteMany();cov_2d9zcv67i8().s[18]++;await Worker.deleteMany();cov_2d9zcv67i8().s[19]++;await Chat.deleteMany();cov_2d9zcv67i8().s[20]++;name=`name-${random()}`;cov_2d9zcv67i8().s[21]++;surname=`surname-${random()}`;cov_2d9zcv67i8().s[22]++;email=`e-${random()}@mail.com`;cov_2d9zcv67i8().s[23]++;password=`password-${random()}`;cov_2d9zcv67i8().s[24]++;adress=`street-${random()}`;const hash=(cov_2d9zcv67i8().s[25]++,await bcrypt.hash(password,10));const user=(cov_2d9zcv67i8().s[26]++,await User.create({name,surname,email,password:hash,adress}));cov_2d9zcv67i8().s[27]++;jwtPromised.sign({sub:user.id},SECRET).then(token=>{cov_2d9zcv67i8().f[3]++;cov_2d9zcv67i8().s[28]++;return context.storage.token=token;});cov_2d9zcv67i8().s[29]++;userId=user.id;cov_2d9zcv67i8().s[30]++;nameW=`name-${random()}`;cov_2d9zcv67i8().s[31]++;surnameW=`surname-${random()}`;cov_2d9zcv67i8().s[32]++;emailW=`e-${random()}@mail.com`;cov_2d9zcv67i8().s[33]++;passwordW=`password-${random()}`;cov_2d9zcv67i8().s[34]++;adressW=`street-${random()}`;cov_2d9zcv67i8().s[35]++;bankAcount=`bankAcount-${random()}`;cov_2d9zcv67i8().s[36]++;description=`description-${random()}`;cov_2d9zcv67i8().s[37]++;pricingHour=random()*10;cov_2d9zcv67i8().s[38]++;jobCategories=`jobCategories-${random()}`;cov_2d9zcv67i8().s[39]++;workingDistance=random()*10;const hashW=(cov_2d9zcv67i8().s[40]++,await bcrypt.hash(password,10));const worker=(cov_2d9zcv67i8().s[41]++,await Worker.create({name:nameW,surname:surnameW,email:emailW,password:hashW,adress,adressW,bankAcount,description,pricingHour,jobCategories,workingDistance}));cov_2d9zcv67i8().s[42]++;workerId=worker.id;const chat=(cov_2d9zcv67i8().s[43]++,await Chat.create({user:ObjectId(userId),worker:ObjectId(workerId),date:new Date()}));cov_2d9zcv67i8().s[44]++;message='hello'+worker.name;cov_2d9zcv67i8().s[45]++;chat.messages.unshift(new Comments({userId:ObjectId(userId),name:name,surname:surname,text:message,date:new Date()}));cov_2d9zcv67i8().s[46]++;await chat.save();cov_2d9zcv67i8().s[47]++;chatId=chat._id;});cov_2d9zcv67i8().s[48]++;it('should succeed on valid data',async()=>{cov_2d9zcv67i8().f[4]++;const result=(cov_2d9zcv67i8().s[49]++,await retriveChat(chatId));cov_2d9zcv67i8().s[50]++;expect(result).to.exist;cov_2d9zcv67i8().s[51]++;expect(result.user.toString()).to.equal(userId.toString());cov_2d9zcv67i8().s[52]++;expect(result.worker.toString()).to.equal(workerId.toString());cov_2d9zcv67i8().s[53]++;expect(result.messages[0].name).to.equal(name);cov_2d9zcv67i8().s[54]++;expect(result.messages[0].surname).to.equal(surname);cov_2d9zcv67i8().s[55]++;expect(result.messages[0].text).to.equal(message);});cov_2d9zcv67i8().s[56]++;it('sould fail when empty chat id',async()=>{cov_2d9zcv67i8().f[5]++;cov_2d9zcv67i8().s[57]++;try{const result=(cov_2d9zcv67i8().s[58]++,await retriveChat(""));}catch({message}){cov_2d9zcv67i8().s[59]++;expect(message).to.exist;cov_2d9zcv67i8().s[60]++;expect(message).to.equal('string is empty or blank');}});cov_2d9zcv67i8().s[61]++;it('sould fail when empty non existant chat id',async()=>{cov_2d9zcv67i8().f[6]++;const result=(cov_2d9zcv67i8().s[62]++,await retriveChat("5ef1152a504970548076a9a5").then().catch(error=>{cov_2d9zcv67i8().f[7]++;cov_2d9zcv67i8().s[63]++;expect(error).to.exist;cov_2d9zcv67i8().s[64]++;expect(error.message).to.equal(`chat with id: 5ef1152a504970548076a9a5 dont exists`);}));});// describe('when user already exists', () => {
//     beforeEach(() => Worker.create({ name, surname, email, password, adress, bankAcount, description, presentation, pricingHour, jobCategories, workingDistance }))
//     it('should fail on trying to register an existing user', async () => {
//         try {
//             await registerWorker(name, surname, email, password, adress, bankAcount, description, presentation, pricingHour, jobCategories, workingDistance)
//             throw new Error('should not reach this point')
//         } catch (error) {
//             expect(error).to.exist
//             expect(error).to.be.an.instanceof(Error)
//             expect(error.message).to.equal(`worker with e-mail ${email} already exists`)
//         }
//     })
// })
cov_2d9zcv67i8().s[65]++;afterEach(()=>{cov_2d9zcv67i8().f[8]++;cov_2d9zcv67i8().s[66]++;return Worker.deleteMany();});cov_2d9zcv67i8().s[67]++;after(mongoose.disconnect);});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJldHJpdmUtY2hhdC5zcGVjLmpzIl0sIm5hbWVzIjpbInJlcXVpcmUiLCJjb25maWciLCJlbnYiLCJURVNUX01PTkdPREJfVVJMIiwiTU9OR09EQl9VUkwiLCJURVNUX1NFQ1JFVCIsIlNFQ1JFVCIsIlRFU1RfQVBJX1VSTCIsIkFQSV9VUkwiLCJwcm9jZXNzIiwicmV0cml2ZUNoYXQiLCJyYW5kb20iLCJNYXRoIiwiZXhwZWN0IiwidXRpbHMiLCJqd3RQcm9taXNlZCIsIm1vbmdvb3NlIiwibW9kZWxzIiwiQ2hhdCIsIlVzZXIiLCJXb3JrZXIiLCJDb21tZW50cyIsIk9iamVjdElkIiwiYmNyeXB0IiwiY29udGV4dCIsInN0b3JhZ2UiLCJkZXNjcmliZSIsImJlZm9yZSIsImNvbm5lY3QiLCJuYW1lIiwic3VybmFtZSIsImVtYWlsIiwicGFzc3dvcmQiLCJhZHJlc3MiLCJiYW5rQWNvdW50IiwiZGVzY3JpcHRpb24iLCJwcmljaW5nSG91ciIsImpvYkNhdGVnb3JpZXMiLCJ3b3JraW5nRGlzdGFuY2UiLCJ3b3JrZXJJZCIsInVzZXJJZCIsImNoYXRJZCIsIm1lc3NhZ2UiLCJiZWZvcmVFYWNoIiwiZGVsZXRlTWFueSIsImhhc2giLCJ1c2VyIiwiY3JlYXRlIiwic2lnbiIsInN1YiIsImlkIiwidGhlbiIsInRva2VuIiwibmFtZVciLCJzdXJuYW1lVyIsImVtYWlsVyIsInBhc3N3b3JkVyIsImFkcmVzc1ciLCJoYXNoVyIsIndvcmtlciIsImNoYXQiLCJkYXRlIiwiRGF0ZSIsIm1lc3NhZ2VzIiwidW5zaGlmdCIsInRleHQiLCJzYXZlIiwiX2lkIiwiaXQiLCJyZXN1bHQiLCJ0byIsImV4aXN0IiwidG9TdHJpbmciLCJlcXVhbCIsImNhdGNoIiwiZXJyb3IiLCJhZnRlckVhY2giLCJhZnRlciIsImRpc2Nvbm5lY3QiXSwibWFwcGluZ3MiOiJrek1BZVk7bUhBZlpBLE9BQU8sQ0FBQyxRQUFELENBQVAsQ0FBa0JDLE1BQWxCLEdBRUEsS0FBTSxDQUFFQyxH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RUFDSCxDQUNKLENBUEMsQ0FBRixDQTVFaUMseUJBcUZqQ0wsRUFBRSxDQUFDLDRDQUFELENBQStDLFNBQVkseUJBRXpELEtBQU1DLENBQUFBLE1BQU0sMkJBQUcsS0FBTTNELENBQUFBLFdBQVcsQ0FBQywwQkFBRCxDQUFYLENBQ2hCeUMsSUFEZ0IsR0FFaEJ1QixLQUZnQixDQUVWQyxLQUFLLEVBQUksa0RBQ1o5RCxNQUFNLENBQUM4RCxLQUFELENBQU4sQ0FBY0wsRUFBZCxDQUFpQkMsS0FBakIsQ0FEWSx5QkFFWjFELE1BQU0sQ0FBQzhELEtBQUssQ0FBQ2pDLE9BQVAsQ0FBTixDQUFzQjRCLEVBQXRCLENBQXlCRyxLQUF6QixDQUFnQyxvREFBaEMsRUFDSCxDQUxnQixDQUFULENBQVosQ0FPSCxDQVRDLENBQUYsQ0FhQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWpIaUMseUJBbUhqQ0csU0FBUyxDQUFDLElBQU0sd0RBQUF4RCxDQUFBQSxNQUFNLENBQUN3QixVQUFQLEdBQW1CLENBQTFCLENBQVQsQ0FuSGlDLHlCQXFIakNpQyxLQUFLLENBQUM3RCxRQUFRLENBQUM4RCxVQUFWLENBQUwsQ0FDSCxDQXRITyxDQUFSIiwic291cmNlc0NvbnRlbnQiOlsicmVxdWlyZSgnZG90ZW52JykuY29uZmlnKClcclxuXHJcbmNvbnN0IHsgZW52OiB7IFRFU1RfTU9OR09EQl9VUkw6IE1PTkdPREJfVVJMLCBURVNUX1NFQ1JFVDogU0VDUkVULCBURVNUX0FQSV9VUkw6IEFQSV9VUkwgIH0gfSA9IHByb2Nlc3NcclxuXHJcbmNvbnN0IHJldHJpdmVDaGF0ID0gcmVxdWlyZSgnLi9yZXRyaXZlLWNoYXQnKVxyXG5jb25zdCB7IHJhbmRvbSB9ID0gTWF0aFxyXG5jb25zdCB7IGV4cGVjdCB9ID0gcmVxdWlyZSgnY2hhaScpXHJcbnJlcXVpcmUoJ3Rha2VteXRhc2stY29tbW9ucy9wb2x5ZmlsbHMvanNvbicpXHJcbmNvbnN0IHsgdXRpbHM6IHsgand0UHJvbWlzZWQgfSB9ID0gcmVxdWlyZSgndGFrZW15dGFzay1jb21tb25zJylcclxuY29uc3QgeyBtb25nb29zZSwgbW9kZWxzOiB7IENoYXQsIFVzZXIsIFdvcmtlciwgQ29tbWVudHMgfSwgbW9uZ29vc2U6IHtPYmplY3RJZH0gfSA9IHJlcXVpcmUoJ3Rha2VteXRhc2stZGF0YScpXHJcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdGpzJylcclxucmVxdWlyZSgndGFrZW15dGFzay1jb21tb25zL3BvbnlmaWxscy94aHInKVxyXG5jb25zdCBjb250ZXh0ID0gcmVxdWlyZSgnLi9jb250ZXh0JylcclxuXHJcbmNvbnRleHQuQVBJX1VSTCA9IEFQSV9VUkxcclxuXHJcbmNvbnRleHQuc3RvcmFnZSA9IHt9XHJcblxyXG5kZXNjcmliZSgnbG9naWMgLSBjcmVhdCBjaGF0JywgKCkgPT4ge1xyXG4gICAgYmVmb3JlKCgpID0+IG1vbmdvb3NlLmNvbm5lY3QoTU9OR09EQl9VUkwpKVxyXG5cclxuICAgIGxldCBuYW1lLCBzdXJuYW1lLCBlbWFpbCwgcGFzc3dvcmQsIGFkcmVzcywgYmFua0Fjb3VudCwgZGVzY3JpcHRpb24sIHByaWNpbmdIb3VyLCBqb2JDYXRlZ29yaWVzLCB3b3JraW5nRGlzdGFuY2UsIHdvcmtlcklkLCB1c2VySWQsIGNoYXRJZCwgbWVzc2FnZVxyXG5cclxuICAgIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIGF3YWl0IFVzZXIuZGVsZXRlTWFueSgpXHJcbiAgICAgICAgYXdhaXQgV29ya2VyLmRlbGV0ZU1hbnkoKVxyXG4gICAgICAgIGF3YWl0IENoYXQuZGVsZXRlTWFueSgpXHJcblxyXG4gICAgICAgIG5hbWUgPSBgbmFtZS0ke3JhbmRvbSgpfWBcclxuICAgICAgICBzdXJuYW1lID0gYHN1cm5hbWUtJHtyYW5kb20oKX1gXHJcbiAgICAgICAgZW1haWwgPSBgZS0ke3JhbmRvbSgpfUBtYWlsLmNvbWBcclxuICAgICAgICBwYXNzd29yZCA9IGBwYXNzd29yZC0ke3JhbmRvbSgpfWBcclxuICAgICAgICBhZHJlc3MgPSBgc3RyZWV0LSR7cmFuZG9tKCl9YFxyXG5cclxuICAgICAgICBjb25zdCBoYXNoID0gYXdhaXQgYmNyeXB0Lmhhc2gocGFzc3dvcmQsIDEwKVxyXG5cclxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5jcmVhdGUoe25hbWUsIHN1cm5hbWUsIGVtYWlsLCBwYXNzd29yZDogaGFzaCwgYWRyZXNzfSlcclxuICAgICAgICBcclxuICAgICAgICBqd3RQcm9taXNlZC5zaWduKHsgc3ViOiB1c2VyLmlkIH0sIFNFQ1JFVClcclxuICAgICAgICAgICAgLnRoZW4oKHRva2VuKSA9PiBjb250ZXh0LnN0b3JhZ2UudG9rZW4gPSB0b2tlbilcclxuICAgICAgICBcclxuICAgICAgICB1c2VySWQgPSB1c2VyLmlkXHJcbiAgICBcclxuICAgICAgICBuYW1lVyA9IGBuYW1lLSR7cmFuZG9tKCl9YFxyXG4gICAgICAgIHN1cm5hbWVXID0gYHN1cm5hbWUtJHtyYW5kb20oKX1gXHJcbiAgICAgICAgZW1haWxXID0gYGUtJHtyYW5kb20oKX1AbWFpbC5jb21gXHJcbiAgICAgICAgcGFzc3dvcmRXID0gYHBhc3N3b3JkLSR7cmFuZG9tKCl9YFxyXG4gICAgICAgIGFkcmVzc1cgPSBgc3RyZWV0LSR7cmFuZG9tKCl9YFxyXG4gICAgICAgIGJhbmtBY291bnQgPSBgYmFua0Fjb3VudC0ke3JhbmRvbSgpfWBcclxuICAgICAgICBkZXNjcmlwdGlvbiA9IGBkZXNjcmlwdGlvbi0ke3JhbmRvbSgpfWBcclxuICAgICAgICBwcmljaW5nSG91ciA9IHJhbmRvbSgpKjEwXHJcbiAgICAgICAgam9iQ2F0ZWdvcmllcyA9IGBqb2JDYXRlZ29yaWVzLSR7cmFuZG9tKCl9YFxyXG4gICAgICAgIHdvcmtpbmdEaXN0YW5jZSA9IHJhbmRvbSgpKjEwXHJcblxyXG4gICAgICAgIGNvbnN0IGhhc2hXID0gYXdhaXQgYmNyeXB0Lmhhc2gocGFzc3dvcmQsIDEwKVxyXG5cclxuICAgICAgICBjb25zdCB3b3JrZXIgPSBhd2FpdCBXb3JrZXIuY3JlYXRlKHtuYW1lOiBuYW1lVywgc3VybmFtZTogc3VybmFtZVcsIGVtYWlsOiBlbWFpbFcsIHBhc3N3b3JkOiBoYXNoVywgYWRyZXNzLCBhZHJlc3NXLCBiYW5rQWNvdW50LCBkZXNjcmlwdGlvbiwgcHJpY2luZ0hvdXIsIGpvYkNhdGVnb3JpZXMsIHdvcmtpbmdEaXN0YW5jZX0pXHJcblxyXG4gICAgICAgIHdvcmtlcklkID0gd29ya2VyLmlkIFxyXG5cclxuICAgICAgICBjb25zdCBjaGF0ID0gYXdhaXQgQ2hhdC5jcmVhdGUoe1xyXG4gICAgICAgICAgICB1c2VyOiBPYmplY3RJZCh1c2VySWQpLCBcclxuICAgICAgICAgICAgd29ya2VyOiBPYmplY3RJZCh3b3JrZXJJZCksIFxyXG4gICAgICAgICAgICBkYXRlOiBuZXcgRGF0ZVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIG1lc3NhZ2UgPSAnaGVsbG8nICsgd29ya2VyLm5hbWVcclxuXHJcbiAgICAgICAgY2hhdC5tZXNzYWdlcy51bnNoaWZ0KCBuZXcgQ29tbWVudHMgKHtcclxuICAgICAgICAgICAgdXNlcklkOiBPYmplY3RJZCh1c2VySWQpLFxyXG4gICAgICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgICAgICBzdXJuYW1lOiBzdXJuYW1lLFxyXG4gICAgICAgICAgICB0ZXh0OiBtZXNzYWdlLFxyXG4gICAgICAgICAgICBkYXRlOiBuZXcgRGF0ZVxyXG4gICAgICAgIH0pKVxyXG5cclxuICAgICAgICBhd2FpdCBjaGF0LnNhdmUoKVxyXG5cclxuICAgICAgICBjaGF0SWQgPSBjaGF0Ll9pZFxyXG5cclxuICAgIH0pXHJcblxyXG4gICAgaXQoJ3Nob3VsZCBzdWNjZWVkIG9uIHZhbGlkIGRhdGEnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmV0cml2ZUNoYXQoY2hhdElkKVxyXG5cclxuICAgICAgICBleHBlY3QocmVzdWx0KS50by5leGlzdFxyXG5cclxuICAgICAgICBleHBlY3QocmVzdWx0LnVzZXIudG9TdHJpbmcoKSkudG8uZXF1YWwodXNlcklkLnRvU3RyaW5nKCkpXHJcbiAgICAgICAgZXhwZWN0KHJlc3VsdC53b3JrZXIudG9TdHJpbmcoKSkudG8uZXF1YWwod29ya2VySWQudG9TdHJpbmcoKSlcclxuICAgICAgICBleHBlY3QocmVzdWx0Lm1lc3NhZ2VzWzBdLm5hbWUpLnRvLmVxdWFsKG5hbWUpXHJcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5tZXNzYWdlc1swXS5zdXJuYW1lKS50by5lcXVhbChzdXJuYW1lKVxyXG4gICAgICAgIGV4cGVjdChyZXN1bHQubWVzc2FnZXNbMF0udGV4dCkudG8uZXF1YWwobWVzc2FnZSlcclxuICAgIH0pXHJcblxyXG4gICAgaXQoJ3NvdWxkIGZhaWwgd2hlbiBlbXB0eSBjaGF0IGlkJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIHRyeXtcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmV0cml2ZUNoYXQoXCJcIilcclxuICAgICAgICB9Y2F0Y2goe21lc3NhZ2V9KXtcclxuICAgICAgICAgICAgZXhwZWN0KG1lc3NhZ2UpLnRvLmV4aXN0XHJcbiAgICAgICAgICAgIGV4cGVjdChtZXNzYWdlKS50by5lcXVhbCgnc3RyaW5nIGlzIGVtcHR5IG9yIGJsYW5rJylcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIGl0KCdzb3VsZCBmYWlsIHdoZW4gZW1wdHkgbm9uIGV4aXN0YW50IGNoYXQgaWQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmV0cml2ZUNoYXQoXCI1ZWYxMTUyYTUwNDk3MDU0ODA3NmE5YTVcIilcclxuICAgICAgICAgICAgLnRoZW4oKVxyXG4gICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICAgICAgZXhwZWN0KGVycm9yKS50by5leGlzdFxyXG4gICAgICAgICAgICAgICAgZXhwZWN0KGVycm9yLm1lc3NhZ2UpLnRvLmVxdWFsKGBjaGF0IHdpdGggaWQ6IDVlZjExNTJhNTA0OTcwNTQ4MDc2YTlhNSBkb250IGV4aXN0c2ApXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgXHJcbiAgICB9KVxyXG4gICAgXHJcblxyXG5cclxuICAgIC8vIGRlc2NyaWJlKCd3aGVuIHVzZXIgYWxyZWFkeSBleGlzdHMnLCAoKSA9PiB7XHJcbiAgICAvLyAgICAgYmVmb3JlRWFjaCgoKSA9PiBXb3JrZXIuY3JlYXRlKHsgbmFtZSwgc3VybmFtZSwgZW1haWwsIHBhc3N3b3JkLCBhZHJlc3MsIGJhbmtBY291bnQsIGRlc2NyaXB0aW9uLCBwcmVzZW50YXRpb24sIHByaWNpbmdIb3VyLCBqb2JDYXRlZ29yaWVzLCB3b3JraW5nRGlzdGFuY2UgfSkpXHJcblxyXG4gICAgLy8gICAgIGl0KCdzaG91bGQgZmFpbCBvbiB0cnlpbmcgdG8gcmVnaXN0ZXIgYW4gZXhpc3RpbmcgdXNlcicsIGFzeW5jICgpID0+IHtcclxuICAgIC8vICAgICAgICAgdHJ5IHtcclxuICAgIC8vICAgICAgICAgICAgIGF3YWl0IHJlZ2lzdGVyV29ya2VyKG5hbWUsIHN1cm5hbWUsIGVtYWlsLCBwYXNzd29yZCwgYWRyZXNzLCBiYW5rQWNvdW50LCBkZXNjcmlwdGlvbiwgcHJlc2VudGF0aW9uLCBwcmljaW5nSG91ciwgam9iQ2F0ZWdvcmllcywgd29ya2luZ0Rpc3RhbmNlKVxyXG5cclxuICAgIC8vICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignc2hvdWxkIG5vdCByZWFjaCB0aGlzIHBvaW50JylcclxuICAgIC8vICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIC8vICAgICAgICAgICAgIGV4cGVjdChlcnJvcikudG8uZXhpc3RcclxuXHJcbiAgICAvLyAgICAgICAgICAgICBleHBlY3QoZXJyb3IpLnRvLmJlLmFuLmluc3RhbmNlb2YoRXJyb3IpXHJcbiAgICAvLyAgICAgICAgICAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG8uZXF1YWwoYHdvcmtlciB3aXRoIGUtbWFpbCAke2VtYWlsfSBhbHJlYWR5IGV4aXN0c2ApXHJcbiAgICAvLyAgICAgICAgIH1cclxuICAgIC8vICAgICB9KVxyXG4gICAgLy8gfSlcclxuXHJcbiAgICBhZnRlckVhY2goKCkgPT4gV29ya2VyLmRlbGV0ZU1hbnkoKSlcclxuXHJcbiAgICBhZnRlcihtb25nb29zZS5kaXNjb25uZWN0KVxyXG59KSJdfQ==