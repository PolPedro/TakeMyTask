function cov_ncysaryzt(){var path="C:\\Users\\polpe\\bootcamp\\collab\\skylab-bootcamp-202004\\staff\\pol-pedro\\takemytask\\takemytask-server-logic\\retrieve-chat-id.spec.js";var hash="97a93f62460ba955cdd5b1e702a3ee2f83a649a6";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\polpe\\bootcamp\\collab\\skylab-bootcamp-202004\\staff\\pol-pedro\\takemytask\\takemytask-server-logic\\retrieve-chat-id.spec.js",statementMap:{"0":{start:{line:1,column:0},end:{line:1,column:26}},"1":{start:{line:3,column:96},end:{line:3,column:103}},"2":{start:{line:5,column:21},end:{line:5,column:48}},"3":{start:{line:6,column:19},end:{line:6,column:23}},"4":{start:{line:7,column:19},end:{line:7,column:34}},"5":{start:{line:8,column:0},end:{line:8,column:44}},"6":{start:{line:9,column:35},end:{line:9,column:64}},"7":{start:{line:10,column:85},end:{line:10,column:111}},"8":{start:{line:11,column:15},end:{line:11,column:34}},"9":{start:{line:12,column:0},end:{line:12,column:43}},"10":{start:{line:13,column:0},end:{line:107,column:2}},"11":{start:{line:14,column:4},end:{line:14,column:47}},"12":{start:{line:14,column:17},end:{line:14,column:46}},"13":{start:{line:18,column:4},end:{line:72,column:6}},"14":{start:{line:19,column:8},end:{line:19,column:31}},"15":{start:{line:20,column:8},end:{line:20,column:33}},"16":{start:{line:21,column:8},end:{line:21,column:31}},"17":{start:{line:23,column:8},end:{line:23,column:33}},"18":{start:{line:24,column:8},end:{line:24,column:39}},"19":{start:{line:25,column:8},end:{line:25,column:40}},"20":{start:{line:26,column:8},end:{line:26,column:41}},"21":{start:{line:27,column:8},end:{line:27,column:37}},"22":{start:{line:29,column:21},end:{line:29,column:52}},"23":{start:{line:31,column:21},end:{line:31,column:86}},"24":{start:{line:33,column:8},end:{line:33,column:35}},"25":{start:{line:35,column:8},end:{line:35,column:34}},"26":{start:{line:36,column:8},end:{line:36,column:40}},"27":{start:{line:37,column:8},end:{line:37,column:41}},"28":{start:{line:38,column:8},end:{line:38,column:42}},"29":{start:{line:39,column:8},end:{line:39,column:38}},"30":{start:{line:40,column:8},end:{line:40,column:45}},"31":{start:{line:41,column:8},end:{line:41,column:47}},"32":{start:{line:42,column:8},end:{line:42,column:33}},"33":{start:{line:43,column:8},end:{line:43,column:51}},"34":{start:{line:44,column:8},end:{line:44,column:37}},"35":{start:{line:46,column:22},end:{line:46,column:53}},"36":{start:{line:48,column:23},end:{line:48,column:195}},"37":{start:{line:50,column:8},end:{line:50,column:39}},"38":{start:{line:52,column:21},end:{line:56,column:10}},"39":{start:{line:58,column:8},end:{line:58,column:39}},"40":{start:{line:60,column:8},end:{line:66,column:11}},"41":{start:{line:68,column:8},end:{line:68,column:25}},"42":{start:{line:70,column:8},end:{line:70,column:36}},"43":{start:{line:74,column:4},end:{line:85,column:6}},"44":{start:{line:75,column:23},end:{line:75,column:49}},"45":{start:{line:77,column:8},end:{line:77,column:31}},"46":{start:{line:82,column:8},end:{line:82,column:57}},"47":{start:{line:83,column:8},end:{line:83,column:63}},"48":{start:{line:84,column:8},end:{line:84,column:60}},"49":{start:{line:87,column:4},end:{line:102,column:6}},"50":{start:{line:89,column:8},end:{line:91,column:10}},"51":{start:{line:90,column:12},end:{line:90,column:47}},"52":{start:{line:92,column:8},end:{line:101,column:10}},"53":{start:{line:94,column:27},end:{line:99,column:18}},"54":{start:{line:97,column:20},end:{line:97,column:42}},"55":{start:{line:98,column:20},end:{line:98,column:104}},"56":{start:{line:104,column:4},end:{line:104,column:78}},"57":{start:{line:104,column:20},end:{line:104,column:39}},"58":{start:{line:106,column:4},end:{line:106,column:30}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:13,column:34},end:{line:13,column:35}},loc:{start:{line:13,column:40},end:{line:107,column:1}},line:13},"1":{name:"(anonymous_1)",decl:{start:{line:14,column:11},end:{line:14,column:12}},loc:{start:{line:14,column:17},end:{line:14,column:46}},line:14},"2":{name:"(anonymous_2)",decl:{start:{line:18,column:15},end:{line:18,column:16}},loc:{start:{line:18,column:27},end:{line:72,column:5}},line:18},"3":{name:"(anonymous_3)",decl:{start:{line:74,column:39},end:{line:74,column:40}},loc:{start:{line:74,column:51},end:{line:85,column:5}},line:74},"4":{name:"(anonymous_4)",decl:{start:{line:87,column:33},end:{line:87,column:34}},loc:{start:{line:87,column:39},end:{line:102,column:5}},line:87},"5":{name:"(anonymous_5)",decl:{start:{line:89,column:19},end:{line:89,column:20}},loc:{start:{line:89,column:30},end:{line:91,column:9}},line:89},"6":{name:"(anonymous_6)",decl:{start:{line:92,column:50},end:{line:92,column:51}},loc:{start:{line:92,column:62},end:{line:101,column:9}},line:92},"7":{name:"(anonymous_7)",decl:{start:{line:96,column:23},end:{line:96,column:24}},loc:{start:{line:96,column:32},end:{line:99,column:17}},line:96},"8":{name:"(anonymous_8)",decl:{start:{line:104,column:14},end:{line:104,column:15}},loc:{start:{line:104,column:20},end:{line:104,column:39}},line:104}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"97a93f62460ba955cdd5b1e702a3ee2f83a649a6"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_ncysaryzt=function(){return actualCoverage;};}return actualCoverage;}cov_ncysaryzt();cov_ncysaryzt().s[0]++;require('dotenv').config();const{env:{TEST_MONGODB_URL:MONGODB_URL,TEST_SECRET:SECRET,TEST_API_URL:API_URL}}=(cov_ncysaryzt().s[1]++,process);const retriveChats=(cov_ncysaryzt().s[2]++,require('./retive-chat-id'));const{random}=(cov_ncysaryzt().s[3]++,Math);const{expect}=(cov_ncysaryzt().s[4]++,require('chai'));cov_ncysaryzt().s[5]++;require('takemytask-commons/polyfills/json');const{utils:{jwtPromised}}=(cov_ncysaryzt().s[6]++,require('takemytask-commons'));const{mongoose,models:{Chat,User,Worker,Comments},mongoose:{ObjectId}}=(cov_ncysaryzt().s[7]++,require('takemytask-data'));const bcrypt=(cov_ncysaryzt().s[8]++,require('bcryptjs'));cov_ncysaryzt().s[9]++;require('takemytask-commons/ponyfills/xhr');cov_ncysaryzt().s[10]++;describe('logic - retrive chats',()=>{cov_ncysaryzt().f[0]++;cov_ncysaryzt().s[11]++;before(()=>{cov_ncysaryzt().f[1]++;cov_ncysaryzt().s[12]++;return mongoose.connect(MONGODB_URL);});let name,surname,email,password,adress,bankAcount,description,pricingHour,jobCategories,workingDistance,workerId,userId,chatId,message;cov_ncysaryzt().s[13]++;beforeEach(async()=>{cov_ncysaryzt().f[2]++;cov_ncysaryzt().s[14]++;await User.deleteMany();cov_ncysaryzt().s[15]++;await Worker.deleteMany();cov_ncysaryzt().s[16]++;await Chat.deleteMany();cov_ncysaryzt().s[17]++;name=`name-${random()}`;cov_ncysaryzt().s[18]++;surname=`surname-${random()}`;cov_ncysaryzt().s[19]++;email=`e-${random()}@mail.com`;cov_ncysaryzt().s[20]++;password=`password-${random()}`;cov_ncysaryzt().s[21]++;adress=`street-${random()}`;const hash=(cov_ncysaryzt().s[22]++,await bcrypt.hash(password,10));const user=(cov_ncysaryzt().s[23]++,await User.create({name,surname,email,password:hash,adress}));cov_ncysaryzt().s[24]++;userId=user.id.toString();cov_ncysaryzt().s[25]++;nameW=`name-${random()}`;cov_ncysaryzt().s[26]++;surnameW=`surname-${random()}`;cov_ncysaryzt().s[27]++;emailW=`e-${random()}@mail.com`;cov_ncysaryzt().s[28]++;passwordW=`password-${random()}`;cov_ncysaryzt().s[29]++;adressW=`street-${random()}`;cov_ncysaryzt().s[30]++;bankAcount=`bankAcount-${random()}`;cov_ncysaryzt().s[31]++;description=`description-${random()}`;cov_ncysaryzt().s[32]++;pricingHour=random()*10;cov_ncysaryzt().s[33]++;jobCategories=`jobCategories-${random()}`;cov_ncysaryzt().s[34]++;workingDistance=random()*10;const hashW=(cov_ncysaryzt().s[35]++,await bcrypt.hash(password,10));const worker=(cov_ncysaryzt().s[36]++,await Worker.create({name:nameW,surname:surnameW,email:emailW,password:hashW,adress,adressW,bankAcount,description,pricingHour,jobCategories,workingDistance}));cov_ncysaryzt().s[37]++;workerId=worker.id.toString();const chat=(cov_ncysaryzt().s[38]++,await Chat.create({user:ObjectId(userId),worker:ObjectId(workerId),date:new Date()}));cov_ncysaryzt().s[39]++;message='hello'+worker.name;cov_ncysaryzt().s[40]++;chat.messages.unshift(new Comments({userId:ObjectId(userId),name:name,surname:surname,text:message,date:new Date()}));cov_ncysaryzt().s[41]++;await chat.save();cov_ncysaryzt().s[42]++;chatId=chat._id.toString();});cov_ncysaryzt().s[43]++;it('should succeed on valid data',async()=>{cov_ncysaryzt().f[3]++;const result=(cov_ncysaryzt().s[44]++,await retriveChats(userId));cov_ncysaryzt().s[45]++;expect(result).to.exist;// expect(result[0]._id.toString()).to.equal(chatId)
// expect(result[0].user.toString()).to.equal(userId.toString())
// expect(result[0].worker.toString()).to.equal(workerId.toString())
cov_ncysaryzt().s[46]++;expect(result[0].messages[0].name).to.equal(name);cov_ncysaryzt().s[47]++;expect(result[0].messages[0].surname).to.equal(surname);cov_ncysaryzt().s[48]++;expect(result[0].messages[0].text).to.equal(message);});cov_ncysaryzt().s[49]++;describe('chat dont exists',()=>{cov_ncysaryzt().f[4]++;let fakeId;cov_ncysaryzt().s[50]++;beforeEach(async()=>{cov_ncysaryzt().f[5]++;cov_ncysaryzt().s[51]++;fakeId='5ee0ed9a603a0a4f3c650fe1';});cov_ncysaryzt().s[52]++;it('sould fail when user id has no chat',async()=>{cov_ncysaryzt().f[6]++;const result=(cov_ncysaryzt().s[53]++,await retriveChats(userId).then().catch(error=>{cov_ncysaryzt().f[7]++;cov_ncysaryzt().s[54]++;expect(error).to.exist;cov_ncysaryzt().s[55]++;expect(error.message).to.equal(`user with id: 5ee0ed9a603a0a4f3c650fe1 dont exists`);}));});});cov_ncysaryzt().s[56]++;afterEach(()=>{cov_ncysaryzt().f[8]++;cov_ncysaryzt().s[57]++;return Worker.deleteMany();},User.deleteMany(),Chat.deleteMany());cov_ncysaryzt().s[58]++;after(mongoose.disconnect);});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJldHJpZXZlLWNoYXQtaWQuc3BlYy5qcyJdLCJuYW1lcyI6WyJyZXF1aXJlIiwiY29uZmlnIiwiZW52IiwiVEVTVF9NT05HT0RCX1VSTCIsIk1PTkdPREJfVVJMIiwiVEVTVF9TRUNSRVQiLCJTRUNSRVQiLCJURVNUX0FQSV9VUkwiLCJBUElfVVJMIiwicHJvY2VzcyIsInJldHJpdmVDaGF0cyIsInJhbmRvbSIsIk1hdGgiLCJleHBlY3QiLCJ1dGlscyIsImp3dFByb21pc2VkIiwibW9uZ29vc2UiLCJtb2RlbHMiLCJDaGF0IiwiVXNlciIsIldvcmtlciIsIkNvbW1lbnRzIiwiT2JqZWN0SWQiLCJiY3J5cHQiLCJkZXNjcmliZSIsImJlZm9yZSIsImNvbm5lY3QiLCJuYW1lIiwic3VybmFtZSIsImVtYWlsIiwicGFzc3dvcmQiLCJhZHJlc3MiLCJiYW5rQWNvdW50IiwiZGVzY3JpcHRpb24iLCJwcmljaW5nSG91ciIsImpvYkNhdGVnb3JpZXMiLCJ3b3JraW5nRGlzdGFuY2UiLCJ3b3JrZXJJZCIsInVzZXJJZCIsImNoYXRJZCIsIm1lc3NhZ2UiLCJiZWZvcmVFYWNoIiwiZGVsZXRlTWFueSIsImhhc2giLCJ1c2VyIiwiY3JlYXRlIiwiaWQiLCJ0b1N0cmluZyIsIm5hbWVXIiwic3VybmFtZVciLCJlbWFpbFciLCJwYXNzd29yZFciLCJhZHJlc3NXIiwiaGFzaFciLCJ3b3JrZXIiLCJjaGF0IiwiZGF0ZSIsIkRhdGUiLCJtZXNzYWdlcyIsInVuc2hpZnQiLCJ0ZXh0Iiwic2F2ZSIsIl9pZCIsIml0IiwicmVzdWx0IiwidG8iLCJleGlzdCIsImVxdWFsIiwiZmFrZUlkIiwidGhlbiIsImNhdGNoIiwiZXJyb3IiLCJhZnRlckVhY2giLCJhZnRlciIsImRpc2Nvbm5lY3QiXSwibWFwcGluZ3MiOiI0dUxBZVk7Z0hBZlpBLE9BQU8sQ0FBQyxRQUFELENBQVAsQ0FBa0JDLE1BQWxCLEdBRUEsS0FBTSxDQUFFQyxHQUFHLENBQUUsQ0FBRUMsZ0JBQWdCLENBQUVD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QUFDbUQsTUFBTSxDQUFDLENBQUQsQ0FBTixDQUFVTixRQUFWLENBQW1CLENBQW5CLEVBQXNCRSxJQUF2QixDQUFOLENBQW1DSyxFQUFuQyxDQUFzQ0UsS0FBdEMsQ0FBNEMzQixPQUE1QyxFQUNILENBWEMsQ0FBRixDQTdEb0Msd0JBMEVwQ2hCLFFBQVEsQ0FBQyxrQkFBRCxDQUFxQixJQUFNLHdCQUMvQixHQUFJNEMsQ0FBQUEsTUFBSixDQUQrQix3QkFFL0IzQixVQUFVLENBQUMsU0FBVyxnREFDbEIyQixNQUFNLENBQUcsMEJBQVQsQ0FDSCxDQUZTLENBQVYsQ0FGK0Isd0JBSy9CTCxFQUFFLENBQUMscUNBQUQsQ0FBd0MsU0FBWSx3QkFFbEQsS0FBTUMsQ0FBQUEsTUFBTSwwQkFBRyxLQUFNdEQsQ0FBQUEsWUFBWSxDQUFDNEIsTUFBRCxDQUFaLENBQ2hCK0IsSUFEZ0IsR0FFaEJDLEtBRmdCLENBRVZDLEtBQUssRUFBSSxnREFDWjFELE1BQU0sQ0FBQzBELEtBQUQsQ0FBTixDQUFjTixFQUFkLENBQWlCQyxLQUFqQixDQURZLHdCQUVackQsTUFBTSxDQUFDMEQsS0FBSyxDQUFDL0IsT0FBUCxDQUFOLENBQXNCeUIsRUFBdEIsQ0FBeUJFLEtBQXpCLENBQWdDLG9EQUFoQyxFQUNILENBTGdCLENBQVQsQ0FBWixDQU9ILENBVEMsQ0FBRixDQVVILENBZk8sQ0FBUixDQTFFb0Msd0JBMkZwQ0ssU0FBUyxDQUFDLElBQU0sc0RBQUFwRCxDQUFBQSxNQUFNLENBQUNzQixVQUFQLEdBQW1CLENBQTFCLENBQTRCdkIsSUFBSSxDQUFDdUIsVUFBTCxFQUE1QixDQUErQ3hCLElBQUksQ0FBQ3dCLFVBQUwsRUFBL0MsQ0FBVCxDQTNGb0Msd0JBNkZwQytCLEtBQUssQ0FBQ3pELFFBQVEsQ0FBQzBELFVBQVYsQ0FBTCxDQUNILENBOUZPLENBQVIiLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCdkb3RlbnYnKS5jb25maWcoKVxyXG5cclxuY29uc3QgeyBlbnY6IHsgVEVTVF9NT05HT0RCX1VSTDogTU9OR09EQl9VUkwsIFRFU1RfU0VDUkVUOiBTRUNSRVQsIFRFU1RfQVBJX1VSTDogQVBJX1VSTCAgfSB9ID0gcHJvY2Vzc1xyXG5cclxuY29uc3QgcmV0cml2ZUNoYXRzID0gcmVxdWlyZSgnLi9yZXRpdmUtY2hhdC1pZCcpXHJcbmNvbnN0IHsgcmFuZG9tIH0gPSBNYXRoXHJcbmNvbnN0IHsgZXhwZWN0IH0gPSByZXF1aXJlKCdjaGFpJylcclxucmVxdWlyZSgndGFrZW15dGFzay1jb21tb25zL3BvbHlmaWxscy9qc29uJylcclxuY29uc3QgeyB1dGlsczogeyBqd3RQcm9taXNlZCB9IH0gPSByZXF1aXJlKCd0YWtlbXl0YXNrLWNvbW1vbnMnKVxyXG5jb25zdCB7IG1vbmdvb3NlLCBtb2RlbHM6IHsgQ2hhdCwgVXNlciwgV29ya2VyLCBDb21tZW50cyB9LCBtb25nb29zZToge09iamVjdElkfSB9ID0gcmVxdWlyZSgndGFrZW15dGFzay1kYXRhJylcclxuY29uc3QgYmNyeXB0ID0gcmVxdWlyZSgnYmNyeXB0anMnKVxyXG5yZXF1aXJlKCd0YWtlbXl0YXNrLWNvbW1vbnMvcG9ueWZpbGxzL3hocicpXHJcbmRlc2NyaWJlKCdsb2dpYyAtIHJldHJpdmUgY2hhdHMnLCAoKSA9PiB7XHJcbiAgICBiZWZvcmUoKCkgPT4gbW9uZ29vc2UuY29ubmVjdChNT05HT0RCX1VSTCkpXHJcblxyXG4gICAgbGV0IG5hbWUsIHN1cm5hbWUsIGVtYWlsLCBwYXNzd29yZCwgYWRyZXNzLCBiYW5rQWNvdW50LCBkZXNjcmlwdGlvbiwgcHJpY2luZ0hvdXIsIGpvYkNhdGVnb3JpZXMsIHdvcmtpbmdEaXN0YW5jZSwgd29ya2VySWQsIHVzZXJJZCwgY2hhdElkLCBtZXNzYWdlXHJcblxyXG4gICAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgYXdhaXQgVXNlci5kZWxldGVNYW55KClcclxuICAgICAgICBhd2FpdCBXb3JrZXIuZGVsZXRlTWFueSgpXHJcbiAgICAgICAgYXdhaXQgQ2hhdC5kZWxldGVNYW55KClcclxuXHJcbiAgICAgICAgbmFtZSA9IGBuYW1lLSR7cmFuZG9tKCl9YFxyXG4gICAgICAgIHN1cm5hbWUgPSBgc3VybmFtZS0ke3JhbmRvbSgpfWBcclxuICAgICAgICBlbWFpbCA9IGBlLSR7cmFuZG9tKCl9QG1haWwuY29tYFxyXG4gICAgICAgIHBhc3N3b3JkID0gYHBhc3N3b3JkLSR7cmFuZG9tKCl9YFxyXG4gICAgICAgIGFkcmVzcyA9IGBzdHJlZXQtJHtyYW5kb20oKX1gXHJcblxyXG4gICAgICAgIGNvbnN0IGhhc2ggPSBhd2FpdCBiY3J5cHQuaGFzaChwYXNzd29yZCwgMTApXHJcblxyXG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmNyZWF0ZSh7bmFtZSwgc3VybmFtZSwgZW1haWwsIHBhc3N3b3JkOiBoYXNoLCBhZHJlc3N9KVxyXG4gICAgICAgIFxyXG4gICAgICAgIHVzZXJJZCA9IHVzZXIuaWQudG9TdHJpbmcoKVxyXG4gICAgXHJcbiAgICAgICAgbmFtZVcgPSBgbmFtZS0ke3JhbmRvbSgpfWBcclxuICAgICAgICBzdXJuYW1lVyA9IGBzdXJuYW1lLSR7cmFuZG9tKCl9YFxyXG4gICAgICAgIGVtYWlsVyA9IGBlLSR7cmFuZG9tKCl9QG1haWwuY29tYFxyXG4gICAgICAgIHBhc3N3b3JkVyA9IGBwYXNzd29yZC0ke3JhbmRvbSgpfWBcclxuICAgICAgICBhZHJlc3NXID0gYHN0cmVldC0ke3JhbmRvbSgpfWBcclxuICAgICAgICBiYW5rQWNvdW50ID0gYGJhbmtBY291bnQtJHtyYW5kb20oKX1gXHJcbiAgICAgICAgZGVzY3JpcHRpb24gPSBgZGVzY3JpcHRpb24tJHtyYW5kb20oKX1gXHJcbiAgICAgICAgcHJpY2luZ0hvdXIgPSByYW5kb20oKSoxMFxyXG4gICAgICAgIGpvYkNhdGVnb3JpZXMgPSBgam9iQ2F0ZWdvcmllcy0ke3JhbmRvbSgpfWBcclxuICAgICAgICB3b3JraW5nRGlzdGFuY2UgPSByYW5kb20oKSoxMFxyXG5cclxuICAgICAgICBjb25zdCBoYXNoVyA9IGF3YWl0IGJjcnlwdC5oYXNoKHBhc3N3b3JkLCAxMClcclxuXHJcbiAgICAgICAgY29uc3Qgd29ya2VyID0gYXdhaXQgV29ya2VyLmNyZWF0ZSh7bmFtZTogbmFtZVcsIHN1cm5hbWU6IHN1cm5hbWVXLCBlbWFpbDogZW1haWxXLCBwYXNzd29yZDogaGFzaFcsIGFkcmVzcywgYWRyZXNzVywgYmFua0Fjb3VudCwgZGVzY3JpcHRpb24sIHByaWNpbmdIb3VyLCBqb2JDYXRlZ29yaWVzLCB3b3JraW5nRGlzdGFuY2V9KVxyXG5cclxuICAgICAgICB3b3JrZXJJZCA9IHdvcmtlci5pZC50b1N0cmluZygpXHJcblxyXG4gICAgICAgIGNvbnN0IGNoYXQgPSBhd2FpdCBDaGF0LmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIHVzZXI6IE9iamVjdElkKHVzZXJJZCksIFxyXG4gICAgICAgICAgICB3b3JrZXI6IE9iamVjdElkKHdvcmtlcklkKSwgXHJcbiAgICAgICAgICAgIGRhdGU6IG5ldyBEYXRlXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgbWVzc2FnZSA9ICdoZWxsbycgKyB3b3JrZXIubmFtZVxyXG5cclxuICAgICAgICBjaGF0Lm1lc3NhZ2VzLnVuc2hpZnQoIG5ldyBDb21tZW50cyAoe1xyXG4gICAgICAgICAgICB1c2VySWQ6IE9iamVjdElkKHVzZXJJZCksXHJcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgICAgIHN1cm5hbWU6IHN1cm5hbWUsXHJcbiAgICAgICAgICAgIHRleHQ6IG1lc3NhZ2UsXHJcbiAgICAgICAgICAgIGRhdGU6IG5ldyBEYXRlXHJcbiAgICAgICAgfSkpXHJcblxyXG4gICAgICAgIGF3YWl0IGNoYXQuc2F2ZSgpXHJcblxyXG4gICAgICAgIGNoYXRJZCA9IGNoYXQuX2lkLnRvU3RyaW5nKClcclxuXHJcbiAgICB9KVxyXG5cclxuICAgIGl0KCdzaG91bGQgc3VjY2VlZCBvbiB2YWxpZCBkYXRhJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJldHJpdmVDaGF0cyh1c2VySWQpXHJcblxyXG4gICAgICAgIGV4cGVjdChyZXN1bHQpLnRvLmV4aXN0XHJcblxyXG4gICAgICAgIC8vIGV4cGVjdChyZXN1bHRbMF0uX2lkLnRvU3RyaW5nKCkpLnRvLmVxdWFsKGNoYXRJZClcclxuICAgICAgICAvLyBleHBlY3QocmVzdWx0WzBdLnVzZXIudG9TdHJpbmcoKSkudG8uZXF1YWwodXNlcklkLnRvU3RyaW5nKCkpXHJcbiAgICAgICAgLy8gZXhwZWN0KHJlc3VsdFswXS53b3JrZXIudG9TdHJpbmcoKSkudG8uZXF1YWwod29ya2VySWQudG9TdHJpbmcoKSlcclxuICAgICAgICBleHBlY3QocmVzdWx0WzBdLm1lc3NhZ2VzWzBdLm5hbWUpLnRvLmVxdWFsKG5hbWUpXHJcbiAgICAgICAgZXhwZWN0KHJlc3VsdFswXS5tZXNzYWdlc1swXS5zdXJuYW1lKS50by5lcXVhbChzdXJuYW1lKVxyXG4gICAgICAgIGV4cGVjdChyZXN1bHRbMF0ubWVzc2FnZXNbMF0udGV4dCkudG8uZXF1YWwobWVzc2FnZSlcclxuICAgIH0pXHJcblxyXG4gICAgZGVzY3JpYmUoJ2NoYXQgZG9udCBleGlzdHMnLCAoKSA9PiB7XHJcbiAgICAgICAgbGV0IGZha2VJZFxyXG4gICAgICAgIGJlZm9yZUVhY2goYXN5bmMoKSA9PiB7XHJcbiAgICAgICAgICAgIGZha2VJZCA9ICc1ZWUwZWQ5YTYwM2EwYTRmM2M2NTBmZTEnXHJcbiAgICAgICAgfSlcclxuICAgICAgICBpdCgnc291bGQgZmFpbCB3aGVuIHVzZXIgaWQgaGFzIG5vIGNoYXQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJldHJpdmVDaGF0cyh1c2VySWQpXHJcbiAgICAgICAgICAgICAgICAudGhlbigpXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGV4cGVjdChlcnJvcikudG8uZXhpc3RcclxuICAgICAgICAgICAgICAgICAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG8uZXF1YWwoYHVzZXIgd2l0aCBpZDogNWVlMGVkOWE2MDNhMGE0ZjNjNjUwZmUxIGRvbnQgZXhpc3RzYClcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG5cclxuICAgIGFmdGVyRWFjaCgoKSA9PiBXb3JrZXIuZGVsZXRlTWFueSgpLCBVc2VyLmRlbGV0ZU1hbnkoKSwgQ2hhdC5kZWxldGVNYW55KCkpXHJcblxyXG4gICAgYWZ0ZXIobW9uZ29vc2UuZGlzY29ubmVjdClcclxufSkiXX0=